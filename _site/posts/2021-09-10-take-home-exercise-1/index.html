<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>Megan's IS415 Journey: Take-Home Exercise 1: Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia</title>

<meta property="description" itemprop="description" content="This analysis aims to visualise and understand the spatio-temporal patterns of COVID-19 cases in DKI Jakarta and its sub-districts."/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-09-10"/>
<meta property="article:created" itemprop="dateCreated" content="2021-09-10"/>
<meta name="article:author" content="Megan Sim"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Megan&#39;s IS415 Journey: Take-Home Exercise 1: Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This analysis aims to visualise and understand the spatio-temporal patterns of COVID-19 cases in DKI Jakarta and its sub-districts."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Megan&#39;s IS415 Journey"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Megan&#39;s IS415 Journey: Take-Home Exercise 1: Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia"/>
<meta property="twitter:description" content="This analysis aims to visualise and understand the spatio-temporal patterns of COVID-19 cases in DKI Jakarta and its sub-districts."/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output"]}},"value":[{"type":"character","attributes":{},"value":["Take-Home Exercise 1: Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia"]},{"type":"character","attributes":{},"value":["This analysis aims to visualise and understand the spatio-temporal patterns of COVID-19 cases in DKI Jakarta and its sub-districts."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Megan Sim"]},{"type":"character","attributes":{},"value":["https://www.linkedin.com/in/megan-sim-tze-yen/"]}]}]},{"type":"character","attributes":{},"value":["09-10-2021"]},{"type":"character","attributes":{},"value":["Take-Home Exercise","R","sf","tidyverse","tmap","maptools","kableExtra","plyr"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["code_folding","toc","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/aspatial/Standar Kelurahan Data Corona (28 Februari 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 April 2020 Pukul 09.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 April 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 Januari 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 Juni 2020 Pukul 09.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 Juni 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 November 2020 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 September 2020 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Agustus 2020 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Desember 2020 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Juli 2020 Pukul 09.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Juli 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Maret 2020 Pukul 08.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Maret 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 MEI 2020 Pukul 09.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Mei 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Oktober 2020 Pukul 10.00).xlsx","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.cpg","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.dbf","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.prj","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.sbn","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.sbx","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.shp","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.shp.xml","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.shx","images/abnormal_ID.png","images/case_rate.png","images/cases_outerislands.png","images/cases_spatio-temporal.gif","images/CFR.png","images/death_rate.png","images/deaths_spatio-temporal.gif","images/dr_1.png","images/dr_10.png","images/dr_11.png","images/dr_12.png","images/dr_13.png","images/dr_14.png","images/dr_15.png","images/dr_16.png","images/dr_2.png","images/dr_3.png","images/dr_4.png","images/dr_5.png","images/dr_6.png","images/dr_7.png","images/dr_8.png","images/dr_9.png","images/duplicate_jul2020.png","images/duplicate_mar2020.png","images/indonesia_subdivision_breakdown.png","images/meninggal_comparison.png","images/st_1.png","images/st_10.png","images/st_11.png","images/st_12.png","images/st_13.png","images/st_14.png","images/st_15.png","images/st_16.png","images/st_2.png","images/st_3.png","images/st_4.png","images/st_5.png","images/st_6.png","images/st_7.png","images/st_8.png","images/st_9.png","take-home-exercise-1_files/anchor-4.2.2/anchor.min.js","take-home-exercise-1_files/bowser-1.9.3/bowser.min.js","take-home-exercise-1_files/distill-2.2.21/template.v2.js","take-home-exercise-1_files/figure-html5/unnamed-chunk-10-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-12-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-18-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-33-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-38-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-44-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-46-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-46-2.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-46-3.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-46-4.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-46-5.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-50-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-52-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-52-2.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-52-3.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-52-4.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-52-5.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-55-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-55-2.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-55-3.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-55-4.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-55-5.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-60-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-60-2.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-60-3.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-60-4.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-60-5.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-62-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-62-2.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-62-3.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-62-4.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-62-5.png","take-home-exercise-1_files/header-attrs-2.10.6/header-attrs.js","take-home-exercise-1_files/jquery-3.6.0/jquery-3.6.0.js","take-home-exercise-1_files/jquery-3.6.0/jquery-3.6.0.min.js","take-home-exercise-1_files/jquery-3.6.0/jquery-3.6.0.min.map","take-home-exercise-1_files/kePrint-0.0.1/kePrint.js","take-home-exercise-1_files/lightable-0.0.1/lightable.css","take-home-exercise-1_files/popper-2.6.0/popper.min.js","take-home-exercise-1_files/tippy-6.2.7/tippy-bundle.umd.min.js","take-home-exercise-1_files/tippy-6.2.7/tippy-light-border.css","take-home-exercise-1_files/tippy-6.2.7/tippy.css","take-home-exercise-1_files/tippy-6.2.7/tippy.umd.min.js","take-home-exercise-1_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://fonts.googleapis.com/css2?family=Lato');
@import url('https://fonts.googleapis.com/css2?family=Montserrat');
@import url('https://fonts.googleapis.com/css2?family=Fira+Mono');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       0.9rem;                     /* edited */
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #14213d;                    /* edited */
  --header-color:    #14213d;                    /* edited */
  --body-color:      #14213d;                    /* edited */
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    'Lato', sans-serif;         /* edited */
  --mono-font:       'Fira Mono', monospace;     /* edited */
  --body-font:       'Lato', sans-serif;         /* edited */
  --navbar-font:     'Montserrat', sans-serif;   /* edited */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   #14213d;                   /* edited */
  --body-size:       0.8rem;
  --body-color:      #14213d;                   /* edited */
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   #14213d;                   /* edited */
  --text-size:       0.8em;
  --text-color:      #14213d;                   /* edited */
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       20px;                      /* edited */
  --text-color:       #14213d;                   /* edited */
  --text-size:        15px;
  --hover-color:      #ffffff;                   /* edited */
  --bkgd-color:       #fca311;                   /* edited */
}

.distill-site-footer {
  --text-color:       #14213d;                   /* edited */
  --text-size:        15px;
  --hover-color:      #ffffff;                   /* edited */
  --bkgd-color:       #fca311;                   /* edited */
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

d-title {
	height: 100%;
	/* max-height: 600px; */
	width: auto;
	background-color: hsla(200,40%,30%,.4);
	background-image:		
		url('/title_background.png'),
		url('/white.jpg'),
		url('/white.jpg'),
		url('/white.jpg'),
		url('/white.jpg');
	
	background-repeat: repeat-x;
	background-position: 
		0 70%,
		0 100%,
		0 50%,
		0 100%,
		0 0;
	background-size: 
		1200px,
		500px,
		500px 200px,
		500px,
		500px 260px;
	animation: 800s para infinite linear;
	}

@keyframes para {
	100% {
		background-position: 
			-5000px 20%,
			-800px 95%,
			500px 50%,
			1000px 100%,
			400px 0;
		}
	}
	
d-title p{
  background-color: rgba(255, 255, 255, 0.90);   
  line-height: 1.75em;
  text-align: center;
}

d-title h1{
  background-color: rgba(255, 255, 255, 0.90);  
  line-height: 1.75em;
  text-align: center;
}

::-webkit-scrollbar{
    width: 10px;
    height: 5px;
}
::-webkit-scrollbar-track{
    background-color: rgb(255, 255, 255);
    border-radius: 10px;
}
::-webkit-scrollbar-thumb{
    background: rgba(249, 83, 85, 0.20);
    border-radius: 10px;
}
::-webkit-scrollbar-thumb:hover{
    background: rgba(249, 83, 85, 0.30);
}

/*-- animated hand wave --*/
/* credit here: https://jarv.is/notes/css-waving-hand-emoji/ */
.body {
  background-image:	url('/IS415_bg.png');
  background-repeat: no-repeat;
  background-size: cover;
}

.wave {
  animation-name: wave-animation;  /* Refers to the name of your @keyframes element below */
  animation-duration: 2.5s;        /* Change to speed up or slow down */
  animation-iteration-count: infinite;  /* Never stop waving :) */
  transform-origin: 70% 70%;       /* Pivot around the bottom-left palm */
  display: inline-block;
}

@keyframes wave-animation {
    0% { transform: rotate( 0.0deg) }
   10% { transform: rotate(14.0deg) }  /* The following five values can be played with to make the waving more or less extreme */
   20% { transform: rotate(-8.0deg) }
   30% { transform: rotate(14.0deg) }
   40% { transform: rotate(-4.0deg) }
   50% { transform: rotate(10.0deg) }
   60% { transform: rotate( 0.0deg) }  /* Reset for the last half to pause */
  100% { transform: rotate( 0.0deg) }
}
</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.10.6/header-attrs.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Take-Home Exercise 1: Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia","description":"This analysis aims to visualise and understand the spatio-temporal patterns of COVID-19 cases in DKI Jakarta and its sub-districts.","authors":[{"author":"Megan Sim","authorURL":"https://www.linkedin.com/in/megan-sim-tze-yen/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-09-10T00:00:00.000+08:00","citationText":"Sim, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Megan's IS415 Journey</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">
<i class="fa fa-home" aria-hidden="true"></i>
</a>
<a href="../../about.html">whoami</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
In-Class Exercises
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://is415-msty.netlify.app/posts/2021-08-23-in-class-exercise-3/">In-Class Exercise 2</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-02-in-class-exercise-3/">In-Class Exercise 3</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-06-in-class-exercise-4/">In-Class Exercise 4</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-13-in-class-exercise-5/">In-Class Exercise 5</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-18-hands-on-exercise-6/">In-Class Exercise 6</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Hands-On Exercises
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://is415-msty.netlify.app/posts/2021-08-30-hands-on-exercise-2/">Hands-On Exercise 2</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-02-hands-on-exercise-3/">Hands-On Exercise 3</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-05-hands-on-exercise-4/">Hands-On Exercise 4</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-12-hands-on-exercise-5a/">Hands-On Exercise 5A</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-23-hands-on-exercise-5b/">Hands-On Exercise 5B</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-18-hands-on-exercise-6/">Hands-On Exercise 6</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Take-Home Exercises
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://is415-msty.netlify.app/posts/2021-09-10-take-home-exercise-1/">Take-Home Exercise 1</a>
<a href="https://is415-msty.netlify.app/posts/2021-09-19-take-home-exercise-2/">Take-Home Exercise 2</a>
</div>
</div>
<a href="https://github.com/boiledcactus">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/megan-sim-tze-yen/">
<i class="fa fa-linkedin" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Take-Home Exercise 1: Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:Take-Home_Exercise" class="dt-tag">Take-Home Exercise</a>
  <a href="../../index.html#category:R" class="dt-tag">R</a>
  <a href="../../index.html#category:sf" class="dt-tag">sf</a>
  <a href="../../index.html#category:tidyverse" class="dt-tag">tidyverse</a>
  <a href="../../index.html#category:tmap" class="dt-tag">tmap</a>
  <a href="../../index.html#category:maptools" class="dt-tag">maptools</a>
  <a href="../../index.html#category:kableExtra" class="dt-tag">kableExtra</a>
  <a href="../../index.html#category:plyr" class="dt-tag">plyr</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>This analysis aims to visualise and understand the spatio-temporal patterns of COVID-19 cases in DKI Jakarta and its sub-districts.</p></p>
</div>

<div class="d-byline">
  Megan Sim <a href="https://www.linkedin.com/in/megan-sim-tze-yen/" class="uri">https://www.linkedin.com/in/megan-sim-tze-yen/</a> 
  
<br/>09-10-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#overview">1.0 Overview</a>
<ul>
<li><a href="#background">1.1 Background</a></li>
</ul></li>
<li><a href="#problem-statement">1.2 Problem Statement</a></li>
<li><a href="#setup">2.0 Setup</a>
<ul>
<li><a href="#packages-used">2.1 Packages Used</a></li>
<li><a href="#datasets-used">2.2 Datasets Used</a></li>
</ul></li>
<li><a href="#data-wrangling-geospatial-data">3.0 Data Wrangling: Geospatial Data</a>
<ul>
<li><a href="#importing-geospatial-data">3.1 Importing Geospatial Data</a></li>
<li><a href="#data-pre-processing">3.2 Data Pre-Processing</a></li>
<li><a href="#verifying-transforming-coordinate-system">3.3 Verifying + Transforming Coordinate System</a></li>
<li><a href="#removal-of-outer-islands">3.4 Removal of Outer Islands</a></li>
<li><a href="#retaining-first-9-fields-of-bd_jakarta">3.5 Retaining first 9 fields of <code>bd_jakarta</code></a></li>
<li><a href="#renaming-columns-with-translation">3.6 Renaming Columns with Translation</a></li>
<li><a href="#brief-eda">3.7 Brief EDA</a></li>
</ul></li>
<li><a href="#data-wrangling-aspatial-data">4.0 Data Wrangling: Aspatial Data</a>
<ul>
<li><a href="#pre-importing-eda">4.1 Pre-Importing EDA</a></li>
<li><a href="#creating-an-aspatial-data-pre-processing-function">4.2 Creating an Aspatial Data Pre-processing Function</a></li>
<li><a href="#feeding-files-into-our-aspatial_preprocess-function">4.3 Feeding Files into our <code>aspatial_preprocess</code> function</a></li>
<li><a href="#formatting-date-column">4.4 Formatting Date Column</a></li>
<li><a href="#renaming-columns-with-translation-1">4.4 Renaming Columns with Translation</a></li>
<li><a href="#further-data-processing">4.5 Further Data Processing</a></li>
</ul></li>
<li><a href="#geospatial-data-integration">5.0 Geospatial Data Integration</a>
<ul>
<li><a href="#preliminary-joining-eda">5.1 Preliminary joining + EDA</a></li>
<li><a href="#identifying-mismatched-sub-district-records">5.2 Identifying Mismatched Sub-District Records</a></li>
<li><a href="#correcting-mismatched-sub-district-records">5.3 Correcting Mismatched Sub-District Records</a></li>
<li><a href="#joining-eda">5.4 Joining + EDA</a></li>
</ul></li>
<li><a href="#calculations">5.5 Calculations</a>
<ul>
<li><a href="#converting-dataframes-to-sf-objects">5.6 Converting dataframes to sf objects</a></li>
</ul></li>
<li><a href="#mapping-monthly-cumulative-cases-rate">6.0 Mapping: Monthly Cumulative Cases Rate</a>
<ul>
<li><a href="#jenks-choropleth-map">6.1 Jenks Choropleth Map</a></li>
<li><a href="#observations-from-jenks-choropleth-map">6.2 Observations from Jenks Choropleth Map</a></li>
<li><a href="#spatio-temporal-mapping-with-custom-breakpoints">6.3 Spatio-Temporal Mapping with custom breakpoints</a></li>
<li><a href="#observations-from-spatio-temporal-map">6.4 Observations from Spatio-Temporal Map</a></li>
</ul></li>
<li><a href="#mapping-monthly-cumulative-death-rate">7.0 Mapping: Monthly Cumulative Death Rate</a>
<ul>
<li><a href="#jenks-choropleth-map-1">7.1 Jenks Choropleth Map</a></li>
<li><a href="#observations-from-jenks-choropleth-map-1">7.2 Observations from Jenks Choropleth Map</a></li>
<li><a href="#monthly-cumulative-deaths---spatio-temporal-mapping">7.3 Monthly Cumulative Deaths - Spatio-Temporal Mapping</a></li>
<li><a href="#observations-from-spatio-temporal-map-1">7.4 Observations from Spatio-Temporal Map</a></li>
</ul></li>
<li><a href="#mapping-case-fatality-ratio">8.0 Mapping: Case Fatality Ratio</a>
<ul>
<li><a href="#jenks-choropleth-map-2">8.1 Jenks Choropleth Map</a></li>
<li><a href="#observations-from-jenks-choropleth-map-2">7.2 Observations from Jenks Choropleth Map</a></li>
</ul></li>
<li><a href="#conclusions">9.0 Conclusions</a>
<ul>
<li><a href="#why-this-matters">Why This Matters</a></li>
<li><a href="#future-impactsuggestions">Future Impact/Suggestions</a></li>
</ul></li>
<li><a href="#acknowledgements">10.0 Acknowledgements</a>
<ul>
<li><a href="#resources-used">Resources Used</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="overview">1.0 Overview</h2>
<h3 id="background">1.1 Background</h3>
<p>On 2nd March 2020, alarm bells rang across Indonesia: newspapers countrywide printed the same headline, radio stations blared, and worried eyes turned to a televised statement from Preisdent Joko Widodo.</p>
<p>He had just confirmed the first two cases of COVID-19 in the country.</p>
<p>This would mark the start of COVID-19’s influence on Indonesia, spanning over 4 million confirmed cases and over 130,000 reported cumulative deaths to date of writing, and marking Indonesia as the country with the highest number of report COVID-19 cases in Southeast Asia. A quick look at <a href="https://covid19.go.id/peta-sebaran">Indonesia’s official COVID-19 Distribution Map</a> introduces a statistical overview and an approximate geographical estimation of the hardest-hit areas. Yet the breadth of its content belies a level of generalisation - which makes it hard to do analysis on a finer-grained level.</p>
<p>Why does this matter? Out of the 34 provinces in Indonesia, DKI Jakarta made up close to 24% of cumulative confirmed cases - a shocking statistic that bears looking into. As such, our goal is to dive deeper into sub-district levels of data and visualise the spatio-temporal patterns in DKI Jakarta.</p>
<h2 id="problem-statement">1.2 Problem Statement</h2>
<p>This analysis aims to <em>visualise and understand</em> the spatio-temporal patterns of COVID-19 cases in DKI Jakarta and its sub-districts, with our goals being:</p>
<ul>
<li>Examine sub-districts that have a higher number of confirmed cases and deaths relative to other sub-districts and to their own population size (i.e. the rate of cases/death, not the number of cases/deaths)</li>
<li>Reveal the spatio-temporal patterns of COVID-19 cases in the DKI Jakarta province on a sub-district level</li>
<li>Research possible underlying reasons for particular COVID-19 cumulative case/death trends on a sub-district level</li>
</ul>
<h2 id="setup">2.0 Setup</h2>
<h3 id="packages-used">2.1 Packages Used</h3>
<p>The R packages we’ll use for this analysis are:</p>
<ul>
<li><strong>sf</strong>: used for importing, managing, and processing geospatial data</li>
<li><strong>tidyverse</strong>: a collection of packages for data science tasks</li>
<li><strong>tmap</strong>: used for creating thematic maps, such as choropleth and bubble maps</li>
<li><strong>maptools</strong>: a set of tools for manipulating geographic data</li>
<li><strong>kableExtra</strong>: an extension of kable, used for table customisation</li>
<li><strong>plyr</strong>: used for splitting data, applying functions and combining results</li>
</ul>
<p>In addition, the following <strong>tidyverse</strong> packages will be used:</p>
<ul>
<li><strong>readxl</strong> for importing Excel worksheets (.xlsx)</li>
<li><strong>tidyr</strong> for manipulating and tidying data</li>
<li><strong>dplyr</strong> for wrangling and transforming data</li>
<li><strong>ggplot2</strong> for visualising data</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># initialise a list of required packages</span>
<span class='co'># note that 'readxl' is in the list of packages despite being part of tidyverse: as readxl is not a core tidyverse package, it needs to be loaded explicitly</span>
<span class='va'>packages</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'plyr'</span>, <span class='st'>'sf'</span>, <span class='st'>'tidyverse'</span>, <span class='st'>'readxl'</span>, <span class='st'>'tmap'</span>, <span class='st'>'maptools'</span>, <span class='st'>'kableExtra'</span><span class='op'>)</span>

<span class='co'># for each package, check if installed and if not, install it</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>, character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<h3 id="datasets-used">2.2 Datasets Used</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># initialise a dataframe of our geospatial and aspatial data details</span>
<span class='va'>datasets</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  Type<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Geospatial"</span>,
         <span class='st'>"Aspatial"</span><span class='op'>)</span>,
  Name<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"[Batas Desa Provinsi DKI Jakarta](https://www.indonesia-geospasial.com/2020/04/download-shapefile-shp-batas-desa.html)"</span>,
         <span class='st'>"[Standar Kelurahan Data Corona (Monthly)](https://riwayat-file-covid-19-dki-jakarta-jakartagis.hub.arcgis.com/)"</span><span class='op'>)</span>,
  Format<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Shapefile"</span>, 
           <span class='st'>".xlsx"</span><span class='op'>)</span>,
  Description<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub-districts in DKI Jakarta"</span>,
                <span class='st'>"Sub-district level data of daily COVID-19 cases in DKI Jakarta  
                between March 2020~July 2021"</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># with reference to this guide on kableExtra:</span>
<span class='co'># https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html</span>
<span class='co'># kable_material is the name of the kable theme</span>
<span class='co'># 'hover' for to highlight row when hovering, 'scale_down' to adjust table to fit page width</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yihui.org/knitr/'>knitr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://haozhu233.github.io/kableExtra/'>kableExtra</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>datasets</span><span class='op'>)</span>, caption<span class='op'>=</span><span class='st'>"Datasets Used"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_classic.html'>kable_material</a></span><span class='op'>(</span><span class='st'>"hover"</span>, latex_options<span class='op'>=</span><span class='st'>"scale_down"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table class=" lightable-material lightable-hover" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-2">Table 1: </span>Datasets Used
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Name
</th>
<th style="text-align:left;">
Format
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Geospatial
</td>
<td style="text-align:left;">
<a href="https://www.indonesia-geospasial.com/2020/04/download-shapefile-shp-batas-desa.html">Batas Desa Provinsi DKI Jakarta</a>
</td>
<td style="text-align:left;">
Shapefile
</td>
<td style="text-align:left;">
Sub-districts in DKI Jakarta
</td>
</tr>
<tr>
<td style="text-align:left;">
Aspatial
</td>
<td style="text-align:left;">
<a href="https://riwayat-file-covid-19-dki-jakarta-jakartagis.hub.arcgis.com/">Standar Kelurahan Data Corona (Monthly)</a>
</td>
<td style="text-align:left;">
.xlsx
</td>
<td style="text-align:left;">
Sub-district level data of daily COVID-19 cases in DKI Jakarta<br />
between March 2020~July 2021
</td>
</tr>
</tbody>
</table>
</div>
<p>To retrieve the monthly cumulative records for the COVID-19 cases in Jakarta, we took the data compiled on the last day of each month, <em>with an exception</em>: there was a broken link for the 31st January 2021 data file, hence the 30th January 2021 data file was used instead.</p>
<h2 id="data-wrangling-geospatial-data">3.0 Data Wrangling: Geospatial Data</h2>
<h3 id="importing-geospatial-data">3.1 Importing Geospatial Data</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># bd stands for "batas desa", translated as "village boundary"</span>
<span class='co'># reads in geospatial data and stores into bd_jakarta dataframe</span>
<span class='va'>bd_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn<span class='op'>=</span><span class='st'>"data/geospatial"</span>,
                      layer<span class='op'>=</span><span class='st'>"BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Reading layer `BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA&#39; from data source `C:\IS415\IS415_msty\_posts\2021-09-10-take-home-exercise-1\data\geospatial&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 269 features and 161 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 106.3831 ymin: -6.370815 xmax: 106.9728 ymax: -5.184322
Geodetic CRS:  WGS 84</code></pre>
</div>
<p>From the output message, we learn that:</p>
<ul>
<li>Geometry type is multipolygon</li>
<li>269 features, 161 fields</li>
<li>Assigned CRS is <a href="https://epsg.io/4326">WGS 84</a>, the ‘World Geodetic System 1984’. That doesn’t seem appropriate - we’ll come back to that later in 3.3</li>
</ul>
<h3 id="data-pre-processing">3.2 Data Pre-Processing</h3>
<p>Before we even start visualising our data, we have to first check for two things: invalid geometries and missing values, which could impact future calculations and representations.</p>
<p><em>Reference was taken from the senior sample submissions for the code for this section, with credit to Xiao Rong Wong’s <a href="https://rpubs.com/xiaorongw/IS415_Take-home_Ex01">Geographic Analysis of the Supply &amp; Demand of Childcare Services in Singapore</a></em></p>
<h4 id="invalid-geometries">3.2.1 Invalid Geometries</h4>
<p>Let us first check for invalid geometries:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># function breakdown:</span>
<span class='co'># the st_is_valid function checks whether a geometry is valid</span>
<span class='co'># which returns the indices of certain values based on logical conditions</span>
<span class='co'># length returns the length of data objects</span>

<span class='co'># checks for the number of geometries that are NOT valid</span>
<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>st_is_valid</span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 0</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Alternative Method</span>
<span class='co'># test &lt;- st_is_valid(bd_jakarta,reason=TRUE)</span>
<span class='co'># length(which(test!= "Valid Geometry"))</span>
<span class='co'># credit to Rajiv Abraham Xavier https://rpubs.com/rax/Take_Home_Ex01</span>
</code></pre>
</div>
</details>
</div>
<p>There are no invalid geometries.</p>
<h4 id="missing-values">3.2.2 Missing Values</h4>
<p>Now, let us check for missing values:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># the rowSums(is.na(bd_jakarta))!=0 checks every row if there are NA values, returning TRUE or FALSE</span>
<span class='co'># the bd_jakarta 'wrapper' prints said rows that contain NA values</span>
<span class='va'>bd_jakarta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span><span class='op'>)</span><span class='op'>!=</span><span class='fl'>0</span>,<span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>Simple feature collection with 2 features and 161 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 106.8412 ymin: -6.154036 xmax: 106.8612 ymax: -6.144973
Geodetic CRS:  WGS 84
    OBJECT_ID KODE_DESA             DESA   KODE    PROVINSI KAB_KOTA
243     25645  31888888     DANAU SUNTER 318888 DKI JAKARTA     &lt;NA&gt;
244     25646  31888888 DANAU SUNTER DLL 318888 DKI JAKARTA     &lt;NA&gt;
    KECAMATAN DESA_KELUR JUMLAH_PEN JUMLAH_KK LUAS_WILAY KEPADATAN
243      &lt;NA&gt;       &lt;NA&gt;          0         0          0         0
244      &lt;NA&gt;       &lt;NA&gt;          0         0          0         0
    PERPINDAHA JUMLAH_MEN PERUBAHAN WAJIB_KTP SILAM KRISTEN KHATOLIK
243          0          0         0         0     0       0        0
244          0          0         0         0     0       0        0
    HINDU BUDHA KONGHUCU KEPERCAYAA PRIA WANITA BELUM_KAWI KAWIN
243     0     0        0          0    0      0          0     0
244     0     0        0          0    0      0          0     0
    CERAI_HIDU CERAI_MATI U0 U5 U10 U15 U20 U25 U30 U35 U40 U45 U50
243          0          0  0  0   0   0   0   0   0   0   0   0   0
244          0          0  0  0   0   0   0   0   0   0   0   0   0
    U55 U60 U65 U70 U75 TIDAK_BELU BELUM_TAMA TAMAT_SD SLTP SLTA
243   0   0   0   0   0          0          0        0    0    0
244   0   0   0   0   0          0          0        0    0    0
    DIPLOMA_I DIPLOMA_II DIPLOMA_IV STRATA_II STRATA_III BELUM_TIDA
243         0          0          0         0          0          0
244         0          0          0         0          0          0
    APARATUR_P TENAGA_PEN WIRASWASTA PERTANIAN NELAYAN AGAMA_DAN
243          0          0          0         0       0         0
244          0          0          0         0       0         0
    PELAJAR_MA TENAGA_KES PENSIUNAN LAINNYA GENERATED KODE_DES_1
243          0          0         0       0      &lt;NA&gt;       &lt;NA&gt;
244          0          0         0       0      &lt;NA&gt;       &lt;NA&gt;
    BELUM_ MENGUR_ PELAJAR_ PENSIUNA_1 PEGAWAI_ TENTARA KEPOLISIAN
243      0       0        0          0        0       0          0
244      0       0        0          0        0       0          0
    PERDAG_ PETANI PETERN_ NELAYAN_1 INDUSTR_ KONSTR_ TRANSP_ KARYAW_
243       0      0       0         0        0       0       0       0
244       0      0       0         0        0       0       0       0
    KARYAW1 KARYAW1_1 KARYAW1_12 BURUH BURUH_ BURUH1 BURUH1_1
243       0         0          0     0      0      0        0
244       0         0          0     0      0      0        0
    PEMBANT_ TUKANG TUKANG_1 TUKANG_12 TUKANG__13 TUKANG__14
243        0      0        0         0          0          0
244        0      0        0         0          0          0
    TUKANG__15 TUKANG__16 TUKANG__17 PENATA PENATA_ PENATA1_1 MEKANIK
243          0          0          0      0       0         0       0
244          0          0          0      0       0         0       0
    SENIMAN_ TABIB PARAJI_ PERANCA_ PENTER_ IMAM_M PENDETA PASTOR
243        0     0       0        0       0      0       0      0
244        0     0       0        0       0      0       0      0
    WARTAWAN USTADZ JURU_M PROMOT ANGGOTA_ ANGGOTA1 ANGGOTA1_1
243        0      0      0      0        0        0          0
244        0      0      0      0        0        0          0
    PRESIDEN WAKIL_PRES ANGGOTA1_2 ANGGOTA1_3 DUTA_B GUBERNUR
243        0          0          0          0      0        0
244        0          0          0          0      0        0
    WAKIL_GUBE BUPATI WAKIL_BUPA WALIKOTA WAKIL_WALI ANGGOTA1_4
243          0      0          0        0          0          0
244          0      0          0        0          0          0
    ANGGOTA1_5 DOSEN GURU PILOT PENGACARA_ NOTARIS ARSITEK AKUNTA_
243          0     0    0     0          0       0       0       0
244          0     0    0     0          0       0       0       0
    KONSUL_ DOKTER BIDAN PERAWAT APOTEK_ PSIKIATER PENYIA_ PENYIA1
243       0      0     0       0       0         0       0       0
244       0      0     0       0       0         0       0       0
    PELAUT PENELITI SOPIR PIALAN PARANORMAL PEDAGA_ PERANG_ KEPALA_
243      0        0     0      0          0       0       0       0
244      0        0     0      0          0       0       0       0
    BIARAW_ WIRASWAST_ LAINNYA_12 LUAS_DESA KODE_DES_3 DESA_KEL_1
243       0          0          0         0       &lt;NA&gt;       &lt;NA&gt;
244       0          0          0         0       &lt;NA&gt;       &lt;NA&gt;
    KODE_12                       geometry
243       0 MULTIPOLYGON (((106.8612 -6...
244       0 MULTIPOLYGON (((106.8504 -6...</code></pre>
</div>
<p>That’s a long output! There are too many columns, and it’ll clutter up future analysis - which we’ll take care of in 3.5. As we can see, there are two particular rows with missing values for <code>KAB_KOTA</code> (City), <code>KECAMATAN</code> (District) and <code>DESA_KELUR</code> (Village), as well as a few other fields - specifically, OBJECT_ID 25645 and 25646. We’ll remove them:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># removes rows that have an NA value in DESA_KELUR</span>
<span class='co'># in context of this data, we can use other columns, such as KAB_KOTA or KECAMATAN</span>
<span class='co'># but since we're looking at this on a sub-district level, DESA_KELUR seemed most appropriate</span>
<span class='va'>bd_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>bd_jakarta</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DESA_KELUR"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="verifying-transforming-coordinate-system">3.3 Verifying + Transforming Coordinate System</h3>
<p>Let us check the CRS of <code>bd_jarkarta</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># retrieves the coordinate system of bd_jakarta</span>
<span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&quot;latitude&quot;,north,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        AXIS[&quot;longitude&quot;,east,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    ID[&quot;EPSG&quot;,4326]]</code></pre>
</div>
<p>As we can see, the assigned coordinates system is <a href="https://epsg.io/4326">WGS 84</a>, the ‘World Geodetic System 1984’. In the context of this dataset, this isn’t appropriate: as this is an Indonesian-specific geospatial dataset, we should be using the national CRS of Indonesia, <a href="https://epsg.io/23845">DGN95</a>, the ‘Datum Geodesi Nasional 1995’, ESPG code 23845. Let’s rectify that:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># transforms the CRS to DGN95, ESPG code 23845</span>
<span class='va'>bd_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'>st_transform</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, <span class='fl'>23845</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Let us check if the CRS has been properly assigned:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Coordinate Reference System:
  User input: EPSG:23845 
  wkt:
PROJCRS[&quot;DGN95 / Indonesia TM-3 zone 54.1&quot;,
    BASEGEOGCRS[&quot;DGN95&quot;,
        DATUM[&quot;Datum Geodesi Nasional 1995&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4755]],
    CONVERSION[&quot;Indonesia TM-3 zone 54.1&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,139.5,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,0.9999,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,200000,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,1500000,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;easting (X)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;northing (Y)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre.&quot;],
        AREA[&quot;Indonesia - onshore east of 138Â°E.&quot;],
        BBOX[-9.19,138,-1.49,141.01]],
    ID[&quot;EPSG&quot;,23845]]</code></pre>
</div>
<p>Success! 😄</p>
<h3 id="removal-of-outer-islands">3.4 Removal of Outer Islands</h3>
<p>We’ve finished our standard pre-processing! Let’s quickly visualise the data…</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># plots the geometry only</span>
<span class='co'># alternatively, we can use plot(bd_jakarta$geometry)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>st_geometry</span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<p>As we can see, <code>bd_jakarta</code> includes both the mainland and the outer islands. As per the assignment requirements, since the outer islands aren’t relevant to our analysis, we’ll have to remove them.</p>
<p>There are a few ways we can do this - but the best way would be to explore our data. From 3.2.2, we saw an output of all the fields - and drew attention to <code>KAB_KOTA</code> (City), <code>KECAMATAN</code> (District) and <code>DESA_KELUR</code> (Village).</p>
<center>
<img src="images/indonesia_subdivision_breakdown.png" style="width:50.0%" />
</center>
<p>Of these three, KAB_KOTA would be the logical choice: it’s the coarsest-grained level of distinction. Let’s check for its unique values:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># ouputs unique values of the KAB_KOTA field</span>
<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='st'>"KAB_KOTA"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] &quot;JAKARTA BARAT&quot;    &quot;JAKARTA PUSAT&quot;    &quot;KEPULAUAN SERIBU&quot;
[4] &quot;JAKARTA UTARA&quot;    &quot;JAKARTA TIMUR&quot;    &quot;JAKARTA SELATAN&quot; </code></pre>
</div>
<p>As we can see, all cities within Jakarta have a <code>JAKARTA</code> prefix, while <code>KEPULAUAN SERIBU</code> (translated to ‘Thousand Islands’) refers to the outer islands. Just to check, we can visualise <code>KAB_KOTA</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># with bd_jakarta as the input data (setting the 'base')</span>
<span class='co'># draw the KAB_KOTA (city) polygons</span>
<span class='co'># essentially shades the map according to the city divisions</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='st'>"KAB_KOTA"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<p>Now that we know how to identify the outer islands, it’s time to remove them:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># filters out the outer islands by accepting only if the value of KAB_KOTA is NOT KEPULAUAN SERIBU</span>
<span class='va'>bd_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>bd_jakarta</span>, <span class='va'>KAB_KOTA</span> <span class='op'>!=</span> <span class='st'>"KEPULAUAN SERIBU"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="retaining-first-9-fields-of-bd_jakarta">3.5 Retaining first 9 fields of <code>bd_jakarta</code></h3>
<p>In addition, the assignment requires us to retain the only the fields relevant to our analysis - in other words, the first 9 fields in the <code>bd_jakarta</code> data frame.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># filters out other fields by accepting only the first 9 fields</span>
<span class='va'>bd_jakarta</span> <span class='op'>&lt;-</span> <span class='va'>bd_jakarta</span><span class='op'>[</span>, <span class='fl'>0</span><span class='op'>:</span><span class='fl'>9</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<h3 id="renaming-columns-with-translation">3.6 Renaming Columns with Translation</h3>
<p>Lastly, let’s translate the column names of <code>bd_jakarta</code> into English for ease of comprehension:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># with reference to: https://www.codegrepper.com/code-examples/r/rename+column+name+in+r</span>
<span class='co'># renames the columns in the style New_Name = OLD_NAME</span>
<span class='va'>bd_jakarta</span> <span class='op'>&lt;-</span> <span class='va'>bd_jakarta</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>
    Object_ID<span class='op'>=</span><span class='va'>OBJECT_ID</span>,
    Province<span class='op'>=</span><span class='va'>PROVINSI</span>, 
    City<span class='op'>=</span><span class='va'>KAB_KOTA</span>, 
    District<span class='op'>=</span><span class='va'>KECAMATAN</span>, 
    Village_Code<span class='op'>=</span><span class='va'>KODE_DESA</span>, 
    Village<span class='op'>=</span><span class='va'>DESA</span>, 
    Sub_District<span class='op'>=</span><span class='va'>DESA_KELUR</span>,
    Code<span class='op'>=</span><span class='va'>KODE</span>, 
    Total_Population<span class='op'>=</span><span class='va'>JUMLAH_PEN</span>
    <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="brief-eda">3.7 Brief EDA</h3>
<p>Before we move on into importing the aspatial data and into the meat of our geovisualiastion, it’s important to get a feel for the data that we’re working with, especially on the sub-district level. As such, let’s take a quick glimpse:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># reveals the data type of all fields + some values</span>
<span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Rows: 261
Columns: 10
$ Object_ID        &lt;dbl&gt; 25477, 25478, 25397, 25400, 25390, 25391, 2~
$ Village_Code     &lt;chr&gt; &quot;3173031006&quot;, &quot;3173031007&quot;, &quot;3171031003&quot;, &quot;~
$ Village          &lt;chr&gt; &quot;KEAGUNGAN&quot;, &quot;GLODOK&quot;, &quot;HARAPAN MULIA&quot;, &quot;CE~
$ Code             &lt;dbl&gt; 317303, 317303, 317103, 317103, 317102, 317~
$ Province         &lt;chr&gt; &quot;DKI JAKARTA&quot;, &quot;DKI JAKARTA&quot;, &quot;DKI JAKARTA&quot;~
$ City             &lt;chr&gt; &quot;JAKARTA BARAT&quot;, &quot;JAKARTA BARAT&quot;, &quot;JAKARTA ~
$ District         &lt;chr&gt; &quot;TAMAN SARI&quot;, &quot;TAMAN SARI&quot;, &quot;KEMAYORAN&quot;, &quot;K~
$ Sub_District     &lt;chr&gt; &quot;KEAGUNGAN&quot;, &quot;GLODOK&quot;, &quot;HARAPAN MULIA&quot;, &quot;CE~
$ Total_Population &lt;dbl&gt; 21609, 9069, 29085, 41913, 15793, 33383, 35~
$ geometry         &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((-3626874 69...~</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># checks for number of unique sub-districts</span>
<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 261</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='st'>"District"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 42</code></pre>
</div>
<p>Note that there are 261 unique sub-districts, and 42 unique distrcits. The max number of categories for mapping with tmap is 30 - and even though we can adjust the max.categories in tmap_options, 261 segmented sections (and even 42 sections) on a single map is too fragmented and minute for human eyes. As such, the only level which is human-readable is the ‘City’ level:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># shades the map according to the city divisions</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='st'>"City"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<h2 id="data-wrangling-aspatial-data">4.0 Data Wrangling: Aspatial Data</h2>
<h3 id="pre-importing-eda">4.1 Pre-Importing EDA</h3>
<p>In our ‘data/aspatial’ folder, we have multiple .xlsx files ranging from 30 March 2020 to July 2021. However, before we start compiling all of our data, it’s important to understand what we’re working with and to check for any discrepancies, so let’s perform a brief EDA:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># reads the 31st March 2020 .xlsx aspatial data and stores it as mar2020</span>
<span class='va'>mar2020</span> <span class='op'>&lt;-</span> <span class='fu'>read_xlsx</span><span class='op'>(</span><span class='st'>"data/aspatial/Standar Kelurahan Data Corona (31 Maret 2020 Pukul 08.00).xlsx"</span><span class='op'>)</span>
<span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>mar2020</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Rows: 270
Columns: 18
$ ID_KEL...1           &lt;chr&gt; NA, &quot;BELUM DIKETAHUI&quot;, &quot;LUAR DKI JAKART~
$ ID_KEL...2           &lt;chr&gt; NA, &quot;BELUM DIKETAHUI&quot;, &quot;LUAR DKI JAKART~
$ Nama_provinsi        &lt;chr&gt; NA, &quot;BELUM DIKETAHUI&quot;, &quot;LUAR DKI JAKART~
$ nama_kota            &lt;chr&gt; NA, &quot;BELUM DIKETAHUI&quot;, &quot;LUAR DKI JAKART~
$ nama_kecamatan       &lt;chr&gt; NA, &quot;BELUM DIKETAHUI&quot;, &quot;LUAR DKI JAKART~
$ nama_kelurahan       &lt;chr&gt; &quot;TOTAL&quot;, &quot;BELUM DIKETAHUI&quot;, &quot;LUAR DKI J~
$ ODP                  &lt;dbl&gt; 2372, 1005, 274, 56, 37, 26, 24, 17, 17~
$ `Proses Pemantauan`  &lt;dbl&gt; 499, 94, 63, 50, 0, 14, 9, 14, 15, 11, ~
$ `Selesai Pemantauan` &lt;dbl&gt; 1873, 911, 211, 6, 37, 12, 15, 3, 2, 5,~
$ PDP                  &lt;dbl&gt; 1189, 213, 176, 3, 6, 10, 2, 8, 2, 9, 6~
$ `Masih Dirawat`      &lt;dbl&gt; 822, 126, 123, 3, 5, 9, 2, 8, 2, 8, 6, ~
$ `Pulang dan Sehat`   &lt;dbl&gt; 367, 87, 53, 0, 1, 1, 0, 0, 0, 1, 0, 4,~
$ POSITIF              &lt;dbl&gt; 794, 154, 106, 4, 3, 6, 2, 13, 0, 8, 0,~
$ Dirawat              &lt;dbl&gt; 481, 130, 62, 3, 1, 3, 2, 12, 0, 5, 0, ~
$ Sembuh               &lt;dbl&gt; 51, 2, 5, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1,~
$ Meninggal            &lt;dbl&gt; 88, 8, 10, 0, 2, 1, 0, 0, 0, 1, 0, 1, 0~
$ `Self Isolation`     &lt;dbl&gt; 174, 14, 29, 0, 0, 2, 0, 1, 0, 2, 0, 1,~
$ Keterangan           &lt;dbl&gt; 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~</code></pre>
</div>
<p><em>glimpse()</em> reveals to us that there is a duplicate <code>ID_KEL</code> column - which our <em>read_xlsx()</em> function then auto-assigns with a ‘…n’, like so:</p>
<center>
<img src="images/duplicate_mar2020.png" style="width:50.0%" />
</center>
<p>This duplication extends from March 2020 to June 2020, after which another duplicate occurs in July 2020:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># reads the 31st July 2020 .xlsx aspatial data and stores it as jul2020</span>
<span class='va'>jul2020</span> <span class='op'>&lt;-</span> <span class='fu'>read_xlsx</span><span class='op'>(</span><span class='st'>"data/aspatial/Standar Kelurahan Data Corona (31 Juli 2020 Pukul 09.00).xlsx"</span><span class='op'>)</span>
<span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>jul2020</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Rows: 270
Columns: 28
$ ID_KEL                  &lt;chr&gt; NA, &quot;3172051003&quot;, &quot;3173041007&quot;, &quot;317~
$ Nama_provinsi           &lt;chr&gt; NA, &quot;DKI JAKARTA&quot;, &quot;DKI JAKARTA&quot;, &quot;D~
$ nama_kota               &lt;chr&gt; NA, &quot;JAKARTA UTARA&quot;, &quot;JAKARTA BARAT&quot;~
$ nama_kecamatan          &lt;chr&gt; NA, &quot;PADEMANGAN&quot;, &quot;TAMBORA&quot;, &quot;KRAMAT~
$ nama_kelurahan          &lt;chr&gt; &quot;TOTAL&quot;, &quot;ANCOL&quot;, &quot;ANGKE&quot;, &quot;BALE KAM~
$ SUSPEK                  &lt;dbl&gt; 58603, 164, 202, 74, 34, 111, 91, 63~
$ `Perawatan RS`          &lt;dbl&gt; 1617, 8, 4, 9, 0, 0, 1, 1, 6, 0, 10,~
$ `Isolasi di Rumah...8`  &lt;dbl&gt; 2229, 28, 7, 8, 0, 1, 0, 0, 11, 0, 1~
$ `Suspek Meninggal`      &lt;dbl&gt; 2226, 0, 2, 1, 1, 1, 2, 1, 0, 1626, ~
$ `Selesai Isolasi...10`  &lt;dbl&gt; 52531, 128, 189, 56, 33, 109, 88, 61~
$ PROBABLE                &lt;dbl&gt; 628, 0, 0, 0, 0, 0, 0, 0, 1, 587, 0,~
$ `Probable Meninggal`    &lt;dbl&gt; 590, 0, 0, 0, 0, 0, 0, 0, 1, 586, 0,~
$ `Selesai Isolasi...13`  &lt;dbl&gt; 38, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,~
$ `PELAKU PERJALANAN`     &lt;dbl&gt; 2004, 7, 0, 3, 0, 2, 18, 2, 1, 116, ~
$ `Isolasi di Rumah...15` &lt;dbl&gt; 134, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0~
$ `Selesai Isolasi...16`  &lt;dbl&gt; 1870, 5, 0, 2, 0, 2, 18, 2, 1, 116, ~
$ `KONTAK ERAT`           &lt;dbl&gt; 96920, 311, 296, 177, 32, 146, 376, ~
$ `Isolasi di Rumah...18` &lt;dbl&gt; 10389, 34, 16, 81, 1, 26, 7, 11, 112~
$ `Selesai Isolasi...19`  &lt;dbl&gt; 86531, 277, 280, 96, 31, 120, 369, 6~
$ DISCARDED               &lt;dbl&gt; 5818, 4, 22, 22, 0, 14, 6, 7, 26, 87~
$ Meninggal...21          &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, ~
$ `Selesai Isolasi...22`  &lt;dbl&gt; 5817, 4, 22, 22, 0, 14, 6, 7, 26, 86~
$ POSITIF                 &lt;dbl&gt; 21201, 46, 49, 31, 7, 45, 30, 16, 42~
$ Dirawat                 &lt;dbl&gt; 2183, 5, 6, 3, 1, 3, 5, 1, 0, 1209, ~
$ Sembuh                  &lt;dbl&gt; 13208, 38, 36, 21, 5, 21, 23, 13, 31~
$ Meninggal...26          &lt;dbl&gt; 836, 0, 2, 1, 1, 0, 2, 0, 3, 88, 2, ~
$ `Self Isolation`        &lt;dbl&gt; 4974, 3, 5, 6, 0, 21, 0, 2, 8, 2396,~
$ Keterangan              &lt;dbl&gt; 0, NA, NA, NA, NA, NA, NA, NA, NA, N~</code></pre>
</div>
<center>
<img src="images/duplicate_jul2020.png" style="width:50.0%" />
</center>
<p>This time, there are duplicates of the <code>Isolasi di Rumah</code>, <code>Selasi Isolasi</code> and <code>Meninggal</code> columns, and this duplication extends till August 2021. While this might seem concerning, we’ll address this in the following sections.</p>
<h3 id="creating-an-aspatial-data-pre-processing-function">4.2 Creating an Aspatial Data Pre-processing Function</h3>
<p>Firstly, let us list down the requirements for our aspatial data:</p>
<ul>
<li>we only need particular columns of interest (listed below)</li>
<li>we need to create an extra Date column that has the month and year of the observation, which was originally in the file name
<ul>
<li>each file has a regular naming format: Standar Kelurahan Data Corona (DD Month YYYY Pukul Ti.me)</li>
<li>the months in the naming format are in Bahasa Indonesia - for ease of comprehension, we should convert it to English</li>
</ul></li>
<li>there are varying duplicates in each .xlsx that needs to be removed
<ul>
<li>as such, we should ensure that read_xlsx does NOT auto-rename the columns when importing</li>
<li>after which, duplicated columns should be removed with the handy <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/duplicated"><em>duplicated()</em></a> function which returns which elements (rows) are duplicates</li>
<li>in addition, for the <code>Meninggal</code> column we should keep the LAST duplicate, which properly reflects the cumulative death cases</li>
</ul></li>
</ul>
<center>
<img src="images/meninggal_comparison.png" style="width:50.0%" />
</center>
<p>Our columns of interest (those that are relevant to our analysis) are as follows:</p>
<ul>
<li>Name_provinsi (Province)</li>
<li>name_kota (City)</li>
<li>nama_kecamatan (District)</li>
<li>nama_kelurahan (Sub-District)</li>
<li>Meninggal (Cumulative Death Cases)</li>
<li>POSITIF (Cumulative Confirmed Cases)</li>
<li>month</li>
<li>ID</li>
</ul>
<p>Now that we know our requirements, we can do this step-by-step: importing all the files into one df, retaining the necessary columns (and deleting duplicate columns), then adding the <code>date</code> column. Alternatively, we can combine all of these into a function!</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># takes in an aspatial data filepath and returns a processed output</span>
<span class='va'>aspatial_preprocess</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>filepath</span><span class='op'>)</span><span class='op'>{</span>
  <span class='co'># the .name_repair="minimal" is to indicate not to replace duplicate column names with 'NAME...n' like we saw above!</span>
  <span class='co'># reference: https://readxl.tidyverse.org/articles/articles/column-names.html</span>
  <span class='va'>result_file</span> <span class='op'>&lt;-</span> <span class='fu'>read_xlsx</span><span class='op'>(</span><span class='va'>filepath</span>, .name_repair<span class='op'>=</span><span class='st'>"minimal"</span><span class='op'>)</span>
  
  <span class='co'># Remove Duplicate Columns</span>
  <span class='co'># essentially, it's saying "take the columns that aren't duplicated, and if there are duplicates, take the last duplicate"</span>
  <span class='co'># we use fromLast = TRUE to ensure that we keep the last duplicated column</span>
  <span class='co'># reference: https://www.marsja.se/how-to-remove-duplicates-in-r-rows-columns-dplyr/</span>
  <span class='co'># reference: https://stackoverflow.com/questions/16905425/find-duplicate-values-in-r</span>
  <span class='va'>result_file</span> <span class='op'>&lt;-</span> <span class='va'>result_file</span><span class='op'>[</span>, <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>result_file</span><span class='op'>)</span>, fromLast <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>]</span> 
  
  <span class='co'># Create the Date Column</span>
  <span class='co'># the format of our files is: Standar Kelurahan Data Corona (DD Month YYYY Pukul Ti.me)</span>
  <span class='co'># while the start is technically "(", "(" is part of a regular expression and leads to a warning message, so we'll use "Corona" instead. The [[1]] refers to the first element in the list.</span>
  <span class='co'># we're loading it as DD-Month-YYYY format</span>
  <span class='co'># the end is 1 space before "Pukul", which means we have to -2 spaces (one for P, one for space)</span>
  <span class='co'># as such, the most relevant functions are substr (returns a substring) and either str_locate (returns location of substring as an integer matrix) or gregexpr (returns a list of locations of substring)</span>
  <span class='co'># reference https://stackoverflow.com/questions/14249562/find-the-location-of-a-character-in-string</span>
  <span class='va'>startpoint</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gregexpr</a></span><span class='op'>(</span>pattern<span class='op'>=</span><span class='st'>"Corona"</span>, <span class='va'>filepath</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>8</span>
  <span class='va'>endpoint</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gregexpr</a></span><span class='op'>(</span>pattern<span class='op'>=</span><span class='st'>"Pukul"</span>, <span class='va'>filepath</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>-</span> <span class='fl'>2</span>
  <span class='va'>result_file</span><span class='op'>$</span><span class='va'>Date</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>filepath</span>, <span class='va'>startpoint</span>, <span class='va'>endpoint</span><span class='op'>)</span>
  
  <span class='co'># Retain the Relevant Columns</span>
  <span class='va'>result_file</span> <span class='op'>&lt;-</span> <span class='va'>result_file</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>select</span><span class='op'>(</span><span class='st'>"Date"</span>, 
           <span class='st'>"ID_KEL"</span>, 
           <span class='st'>"Nama_provinsi"</span>, 
           <span class='st'>"nama_kota"</span>, 
           <span class='st'>"nama_kecamatan"</span>, 
           <span class='st'>"nama_kelurahan"</span>, 
           <span class='st'>"POSITIF"</span>, 
           <span class='st'>"Meninggal"</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>result_file</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<h3 id="feeding-files-into-our-aspatial_preprocess-function">4.3 Feeding Files into our <code>aspatial_preprocess</code> function</h3>
<p>Now that we have our custom function to preprocess aspatial data, we need to feed file into it. There’s the option of doing it manually, inputting our file names line by line - but with a handy function called <em>list.files()</em> and <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/lapply"><em>lapply()</em></a> (that applies a function to all elements in a list), the process can be cut down to a few lines!</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># in the folder 'data/aspatial', find files with the extension '.xlsx' and add it to our fileslist </span>
<span class='co'># the full.names=TRUE prepends the directory path to the file names, giving a relative file path - otherwise, only the file names (not the paths) would be returned </span>
<span class='co'># reference: https://stat.ethz.ch/R-manual/R-devel/library/base/html/list.files.html</span>
<span class='va'>fileslist</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"data/aspatial"</span>, pattern <span class='op'>=</span> <span class='st'>"*.xlsx"</span>, full.names<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># afterwards, for every element in fileslist, apply aspatial_process function</span>
<span class='va'>dflist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>fileslist</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'>aspatial_preprocess</span><span class='op'>(</span><span class='va'>fileslist</span><span class='op'>[</span><span class='va'>x</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Lastly, we’ll need to convert the <code>dflist</code> into an actual dataframe with <a href="https://www.rdocumentation.org/packages/plyr/versions/1.8.6/topics/ldply"><em>ldply()</em></a>, like so:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cases_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'>ldply</span><span class='op'>(</span><span class='va'>dflist</span>, <span class='va'>data.frame</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Let’s check what <code>cases_jakarta</code> looks like, and make sure the columns are correct:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>cases_jakarta</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Rows: 4,590
Columns: 8
$ Date           &lt;chr&gt; &quot;28 Februari 2021&quot;, &quot;28 Februari 2021&quot;, &quot;28 F~
$ ID_KEL         &lt;chr&gt; NA, &quot;3172051003&quot;, &quot;3173041007&quot;, &quot;3175041005&quot;,~
$ Nama_provinsi  &lt;chr&gt; NA, &quot;DKI JAKARTA&quot;, &quot;DKI JAKARTA&quot;, &quot;DKI JAKART~
$ nama_kota      &lt;chr&gt; NA, &quot;JAKARTA UTARA&quot;, &quot;JAKARTA BARAT&quot;, &quot;JAKART~
$ nama_kecamatan &lt;chr&gt; NA, &quot;PADEMANGAN&quot;, &quot;TAMBORA&quot;, &quot;KRAMAT JATI&quot;, &quot;~
$ nama_kelurahan &lt;chr&gt; &quot;TOTAL&quot;, &quot;ANCOL&quot;, &quot;ANGKE&quot;, &quot;BALE KAMBANG&quot;, &quot;B~
$ POSITIF        &lt;dbl&gt; 339735, 834, 617, 755, 358, 870, 811, 1038, 1~
$ Meninggal      &lt;dbl&gt; 5478, 9, 8, 15, 8, 13, 10, 10, 25, 12, 22, 30~</code></pre>
</div>
<h3 id="formatting-date-column">4.4 Formatting Date Column</h3>
<p>Since the values in the <code>Date</code> column were derived from substrings, they’re naturally in string format. We should <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/as.Date">convert that into datetime</a>, keeping in mind that the values in <code>Date</code> are in Bahasa Indonesia</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># parses the 'Date' column into Month(Full Name)-YYYY datetime objects</span>
<span class='co'># reference: https://stackoverflow.com/questions/53380650/b-y-date-conversion-gives-na</span>

<span class='co'># locale="ind" means that the locale has been set as Indonesia</span>
<span class='fu'><a href='https://rdrr.io/r/base/locales.html'>Sys.setlocale</a></span><span class='op'>(</span>locale<span class='op'>=</span><span class='st'>"ind"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] &quot;LC_COLLATE=Indonesian_Indonesia.1252;LC_CTYPE=Indonesian_Indonesia.1252;LC_MONETARY=Indonesian_Indonesia.1252;LC_NUMERIC=C;LC_TIME=Indonesian_Indonesia.1252&quot;</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cases_jakarta</span><span class='op'>$</span><span class='va'>Date</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>cases_jakarta</span><span class='op'>$</span><span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='va'>cases_jakarta</span><span class='op'>$</span><span class='va'>Date</span>, format <span class='op'>=</span><span class='st'>"%d %B %Y"</span><span class='op'>)</span>

<span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>cases_jakarta</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Rows: 4,590
Columns: 8
$ Date           &lt;date&gt; 2021-02-28, 2021-02-28, 2021-02-28, 2021-02-~
$ ID_KEL         &lt;chr&gt; NA, &quot;3172051003&quot;, &quot;3173041007&quot;, &quot;3175041005&quot;,~
$ Nama_provinsi  &lt;chr&gt; NA, &quot;DKI JAKARTA&quot;, &quot;DKI JAKARTA&quot;, &quot;DKI JAKART~
$ nama_kota      &lt;chr&gt; NA, &quot;JAKARTA UTARA&quot;, &quot;JAKARTA BARAT&quot;, &quot;JAKART~
$ nama_kecamatan &lt;chr&gt; NA, &quot;PADEMANGAN&quot;, &quot;TAMBORA&quot;, &quot;KRAMAT JATI&quot;, &quot;~
$ nama_kelurahan &lt;chr&gt; &quot;TOTAL&quot;, &quot;ANCOL&quot;, &quot;ANGKE&quot;, &quot;BALE KAMBANG&quot;, &quot;B~
$ POSITIF        &lt;dbl&gt; 339735, 834, 617, 755, 358, 870, 811, 1038, 1~
$ Meninggal      &lt;dbl&gt; 5478, 9, 8, 15, 8, 13, 10, 10, 25, 12, 22, 30~</code></pre>
</div>
<h3 id="renaming-columns-with-translation-1">4.4 Renaming Columns with Translation</h3>
<p>Just like what we did in 3.6, we’ll translate the column names to English for ease of comprehension:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># renames the columns in the style New_Name = OLD_NAME</span>
<span class='va'>cases_jakarta</span> <span class='op'>&lt;-</span> <span class='va'>cases_jakarta</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>
    Date<span class='op'>=</span><span class='va'>Date</span>,
    ID<span class='op'>=</span><span class='va'>ID_KEL</span>,
    Province<span class='op'>=</span><span class='va'>Nama_provinsi</span>, 
    City<span class='op'>=</span><span class='va'>nama_kota</span>, 
    District<span class='op'>=</span><span class='va'>nama_kecamatan</span>, 
    Sub_District<span class='op'>=</span><span class='va'>nama_kelurahan</span>,
    Cases<span class='op'>=</span><span class='va'>POSITIF</span>, 
    Deaths<span class='op'>=</span><span class='va'>Meninggal</span>
    <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="further-data-processing">4.5 Further Data Processing</h3>
<p>Now that we have our confirmed dataframe, let’s execute any pre-processing we might have missed. Firstly, let’s check for missing values:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># returns rows that contain NA values</span>
<span class='va'>cases_jakarta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>cases_jakarta</span><span class='op'>)</span><span class='op'>)</span><span class='op'>!=</span><span class='fl'>0</span>,<span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>           Date   ID Province City District Sub_District  Cases
1    2021-02-28 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 339735
271  2020-04-30 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL   4138
541  2021-04-30 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 408620
811  2021-01-30 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 266244
1081 2020-06-30 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL  11276
1351 2021-06-30 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 543468
1621 2020-11-30 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 136861
1891 2020-09-30 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL  74368
2161 2020-08-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;         &lt;NA&gt;  40309
2431 2020-12-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 183735
2701 2020-07-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL  21201
2971 2021-07-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 814653
3241 2020-03-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL    794
3511 2021-03-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 382055
3781 2020-05-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL   7272
4051 2021-05-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 430059
4321 2020-10-31 &lt;NA&gt;     &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;        TOTAL 105597
     Deaths
1      5478
271     381
541    6733
811    4254
1081    641
1351   8486
1621   2671
1891   1731
2161   1202
2431   3287
2701    836
2971  12135
3241     88
3511   6341
3781    520
4051   7327
4321   2255</code></pre>
</div>
<p>Since those rows have missing values from their ID all the way to their sub-districts, they should be removed accordingly:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># removes rows that have an NA value in ID</span>
<span class='va'>cases_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>cases_jakarta</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ID"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<center>
<img src="images/abnormal_ID.png" style="width:30.0%" />
</center>
<p>In addition, a brief inspection of <code>cases_jakarta</code> reveals abnormal values for the <code>ID</code> column: specifically, BELUM DIKETAHUI, PROSES UPDATE DATA and LUAR DKI JAKARTA. Let’s remove them:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># removes the rows where ID is BELUM DIKETAHUI, PROSES UPDATE DATA and LUAR DKI JAKARTA</span>
<span class='va'>cases_jakarta</span> <span class='op'>&lt;-</span> <span class='va'>cases_jakarta</span><span class='op'>[</span><span class='op'>!</span><span class='op'>(</span><span class='va'>cases_jakarta</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>==</span><span class='st'>"BELUM DIKETAHUI"</span> <span class='op'>|</span> 
                                   <span class='va'>cases_jakarta</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>==</span><span class='st'>"PROSES UPDATE DATA"</span> <span class='op'>|</span> 
                                   <span class='va'>cases_jakarta</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>==</span><span class='st'>"LUAR DKI JAKARTA"</span><span class='op'>)</span> ,<span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<p>Lastly, we want to remove any records from the Outer Islands where the City is, like these:</p>
<center>
<img src="images/cases_outerislands.png" style="width:75.0%" />
</center>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># filters out the outer islands by accepting only if the value of City is NOT KAB.ADM.KEP.SERIBU</span>
<span class='va'>cases_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>cases_jakarta</span>, <span class='va'>City</span> <span class='op'>!=</span> <span class='st'>"KAB.ADM.KEP.SERIBU"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>With that, we’re done with the data importing and pre-processing! Let’s move on into the next section 💪</p>
<h2 id="geospatial-data-integration">5.0 Geospatial Data Integration</h2>
<h3 id="preliminary-joining-eda">5.1 Preliminary joining + EDA</h3>
<p>Now that we have both the geospatial and aspatial data frames, we’ll need to join them. A quick look at their headers tell us what their common fields are:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># checks for column names of the dataframes</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code> [1] &quot;Object_ID&quot;        &quot;Village_Code&quot;     &quot;Village&quot;         
 [4] &quot;Code&quot;             &quot;Province&quot;         &quot;City&quot;            
 [7] &quot;District&quot;         &quot;Sub_District&quot;     &quot;Total_Population&quot;
[10] &quot;geometry&quot;        </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cases_jakarta</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] &quot;Date&quot;         &quot;ID&quot;           &quot;Province&quot;     &quot;City&quot;        
[5] &quot;District&quot;     &quot;Sub_District&quot; &quot;Cases&quot;        &quot;Deaths&quot;      </code></pre>
</div>
<p>It seems that the Province, City, Distict and Sub_District should match up. Let’s try doing that first:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># joins cases_jakarta to bd_jakarta based on Province, Sub_District and City</span>
<span class='va'>combined_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, <span class='va'>cases_jakarta</span>,
                              by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
                                <span class='st'>"Province"</span><span class='op'>=</span><span class='st'>"Province"</span>, 
                                <span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span>,
                                <span class='st'>"City"</span><span class='op'>=</span><span class='st'>"City"</span><span class='op'>)</span>
                              <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Now, let’s visualise our current <code>combined_jakarta</code> in terms of cases and deaths:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># maps the Cases and Deaths side-by-side</span>
<span class='va'>prelim_cases</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>combined_jakarta</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Cases"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>main.title<span class='op'>=</span><span class='st'>"Preliminary Cases Count"</span><span class='op'>)</span>

<span class='va'>prelim_deaths</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>combined_jakarta</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Deaths"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>main.title<span class='op'>=</span><span class='st'>"Preliminary Death Count"</span><span class='op'>)</span>

<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>prelim_cases</span>, <span class='va'>prelim_deaths</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-33-1.png" width="624" /></p>
</div>
<p>Hmm, that’s not quite right. There are still some ‘missing’ values, but we’ve taken care to remove NA records from both sets of data. The most likely reason for this is due to mistmatched records (one says Berenstein while the other says Berenstain, for example) - which requires addition tweaking and investigation.</p>
<h3 id="identifying-mismatched-sub-district-records">5.2 Identifying Mismatched Sub-District Records</h3>
<p>A brief comparison of the geospatial vs aspatial values reveals to us the mismatch: for the <code>Sub_District</code> field, there isn’t standardisation of the sub-district names, which leads to the same sub-district being referred to by slightly different names, such as <code>KRAMAJATI</code> vs <code>KRAMAT JATI</code>. This is why these records appear as ‘missing values’. To find all of these discrepancies, we should look for sub-district names that appear in our <code>cases_jakarta</code> that don’t appear in <code>bd_jakarta</code>, like so:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># checks for unique values of Sub_District in cases_jakarta that aren't already present in bd_jakarta and vice versa</span>
<span class='va'>cases_subdistrict</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>cases_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>)</span>
<span class='va'>bd_subdistrict</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>cases_subdistrict</span><span class='op'>[</span><span class='op'>!</span><span class='op'>(</span><span class='va'>cases_subdistrict</span> <span class='op'>%in%</span> <span class='va'>bd_subdistrict</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code> [1] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
 [3] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
 [5] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
 [7] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
 [9] &quot;PINANG RANTI&quot;          &quot;RAWA JATI&quot;            </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>bd_subdistrict</span><span class='op'>[</span><span class='op'>!</span><span class='op'>(</span><span class='va'>bd_subdistrict</span> <span class='op'>%in%</span> <span class='va'>cases_subdistrict</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code> [1] &quot;KALIBARU&quot;             &quot;KRENDANG&quot;            
 [3] &quot;RAWAJATI&quot;             &quot;TENGAH&quot;              
 [5] &quot;BALEKAMBANG&quot;          &quot;PINANGRANTI&quot;         
 [7] &quot;JATIPULO&quot;             &quot;PALMERIAM&quot;           
 [9] &quot;KRAMATJATI&quot;           &quot;HALIM PERDANA KUSUMA&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># initialise a dataframe of our cases vs bd subdistrict spelling</span>
<span class='va'>spelling</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  Aspatial_Cases<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BALE KAMBANG"</span>, <span class='st'>"HALIM PERDANA KUSUMAH"</span>, <span class='st'>"JATI PULO"</span>, <span class='st'>"KALI BARU"</span>, <span class='st'>"KAMPUNG TENGAH"</span>, <span class='st'>"KRAMAT JATI"</span>, <span class='st'>"KERENDANG"</span>, <span class='st'>"PAL MERIAM"</span>, <span class='st'>"PINANG RANTI"</span>, <span class='st'>"RAWA JATI"</span><span class='op'>)</span>,
  Geospatial_BD<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BALEKAMBAG"</span>, <span class='st'>"HALIM PERDANA KUSUMA"</span>, <span class='st'>"JATIPULO"</span>, <span class='st'>"KALIBARU"</span>, <span class='st'>"TENGAH"</span>, <span class='st'>"KRAMATJATI"</span>, <span class='st'>"KRENDANG"</span>, <span class='st'>"PALMERIAM"</span>, <span class='st'>"PINANGRANTI"</span>, <span class='st'>"RAWAJATI"</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># with dataframe a input, outputs a kable</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yihui.org/knitr/'>knitr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://haozhu233.github.io/kableExtra/'>kableExtra</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>spelling</span>, caption<span class='op'>=</span><span class='st'>"Mismatched Records"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_classic.html'>kable_material</a></span><span class='op'>(</span><span class='st'>"hover"</span>, latex_options<span class='op'>=</span><span class='st'>"scale_down"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table class=" lightable-material lightable-hover" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-35">Table 2: </span>Mismatched Records
</caption>
<thead>
<tr>
<th style="text-align:left;">
Aspatial_Cases
</th>
<th style="text-align:left;">
Geospatial_BD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
BALE KAMBANG
</td>
<td style="text-align:left;">
BALEKAMBAG
</td>
</tr>
<tr>
<td style="text-align:left;">
HALIM PERDANA KUSUMAH
</td>
<td style="text-align:left;">
HALIM PERDANA KUSUMA
</td>
</tr>
<tr>
<td style="text-align:left;">
JATI PULO
</td>
<td style="text-align:left;">
JATIPULO
</td>
</tr>
<tr>
<td style="text-align:left;">
KALI BARU
</td>
<td style="text-align:left;">
KALIBARU
</td>
</tr>
<tr>
<td style="text-align:left;">
KAMPUNG TENGAH
</td>
<td style="text-align:left;">
TENGAH
</td>
</tr>
<tr>
<td style="text-align:left;">
KRAMAT JATI
</td>
<td style="text-align:left;">
KRAMATJATI
</td>
</tr>
<tr>
<td style="text-align:left;">
KERENDANG
</td>
<td style="text-align:left;">
KRENDANG
</td>
</tr>
<tr>
<td style="text-align:left;">
PAL MERIAM
</td>
<td style="text-align:left;">
PALMERIAM
</td>
</tr>
<tr>
<td style="text-align:left;">
PINANG RANTI
</td>
<td style="text-align:left;">
PINANGRANTI
</td>
</tr>
<tr>
<td style="text-align:left;">
RAWA JATI
</td>
<td style="text-align:left;">
RAWAJATI
</td>
</tr>
</tbody>
</table>
</div>
<h3 id="correcting-mismatched-sub-district-records">5.3 Correcting Mismatched Sub-District Records</h3>
<p>Now that we know which sub-district records are mismatched, we need to rectify the mismatches by renaming them:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># where bd_jakarta is a mismatched value, replace with the correct value</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'BALEKAMBANG'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'BALE KAMBANG'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'HALIM PERDANA KUSUMA'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'HALIM PERDANA KUSUMAH'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'JATIPULO'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'JATI PULO'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'KALIBARU'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'KALI BARU'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'TENGAH'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'KAMPUNG TENGAH'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'KRAMATJATI'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'KRAMAT JATI'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'KRENDANG'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'KERENDANG'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'PALMERIAM'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'PAL MERIAM'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'PINANGRANTI'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'PINANG RANTI'</span>
<span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>[</span><span class='va'>bd_jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span> <span class='op'>==</span> <span class='st'>'RAWAJATI'</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'RAWA JATI'</span>
</code></pre>
</div>
</details>
</div>
<h3 id="joining-eda">5.4 Joining + EDA</h3>
<p>Now, we have a standardised common identifier among our geospatial and aspatial dataframes. Let’s join them once more:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># joins cases_jakarta to bd_jakarta based on Sub_District</span>
<span class='va'>combined_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, <span class='va'>cases_jakarta</span>,
                              by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span>
                              <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Now, let’s once again visualise our updated <code>combined_jakarta</code> in terms of cases and deaths:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># maps the Cases and Deaths side-by-side</span>
<span class='va'>updated_cases</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>combined_jakarta</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Cases"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>main.title<span class='op'>=</span><span class='st'>"Updated Cases Count"</span><span class='op'>)</span>

<span class='va'>updated_deaths</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>combined_jakarta</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Deaths"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>main.title<span class='op'>=</span><span class='st'>"Updated Death Count"</span><span class='op'>)</span>

<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>updated_cases</span>, <span class='va'>updated_deaths</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-38-1.png" width="624" /></p>
</div>
<h2 id="calculations">5.5 Calculations</h2>
<p>Before we move into into EDA and thematic mapping, we need to calculate the cumulative confirmed cases rate (i.e. cases per 10000 population) and the cumulative death rate by month, as per assignment requirements.</p>
<h4 id="cumulative-confirmed-cases-rate">5.5.1 Cumulative Confirmed Cases Rate</h4>
<p>The cumulative confirmed cases rate can be calculated by summing up the number of cases (based on the name of the sub-district and the date), and then dividing by the total population - but do note that the total population represented in our dataframe represents 10,000 denominations (in other words, this is number of cases for every 10,000 people). This can easily be achieved with <a href="https://tidyr.tidyverse.org/reference/pivot_wider.html"><em>pivot_wider()</em></a>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># grouping based on the sub-district and date</span>
<span class='co'># the cumulative_case_rate is based on the sum of cases over the total population</span>
<span class='va'>cases_rate</span> <span class='op'>&lt;-</span> <span class='va'>cases_jakarta</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span> <span class='op'>=</span> <span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Sub_District</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`cumulative_case_rate` <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Cases</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>Total_Population</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
  <span class='co'>#afterwards, pivots the table based on the Dates, using the cumulative case rate as the values</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>Date</span>,
              values_from <span class='op'>=</span> <span class='va'>cumulative_case_rate</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Our <code>case_rate</code> will look like this:</p>
<center>
<img src="images/case_rate.png" style="width:75.0%" />
</center>
<h4 id="cumulative-death-rate">5.5.2 Cumulative Death Rate</h4>
<p>Assumption: Cumulative Death Rate refers to the total number of deaths, divided by population. For total number of deaths over confirmed cases, also known as the Case Fatality Ratio, please refer to section 5.5.3 below!</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># grouping based on the sub-district and date</span>
<span class='co'># the cumulative_case_rate is based on the sum of deaths over the total population</span>
<span class='va'>death_rate</span> <span class='op'>&lt;-</span> <span class='va'>cases_jakarta</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span> <span class='op'>=</span> <span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Sub_District</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`cumulative_death_rate` <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Deaths</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>Total_Population</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
  <span class='co'>#afterwards, pivots the table based on the Dates, showing the cumulative death rate</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>Date</span>,
              values_from <span class='op'>=</span> <span class='va'>cumulative_death_rate</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<center>
<img src="images/death_rate.png" style="width:75.0%" />
</center>
<h4 id="case-fatality-ratio">5.5.3 Case Fatality Ratio</h4>
<p>Case Fatality Ratio, also known as <a href="https://www.who.int/news-room/commentaries/detail/estimating-mortality-from-covid-19#:~:text=Calculating%20CFR%20Case%20fatality%20ratio,severity%20among%20detected%20cases%3A">CFR</a> is the proportion of individuals diagnosed with a disease who die from that disease. Within this context, it refers to the number of people who contacted COVID-19 and passed away. The CFR is used as a measure of severity among detected cases.</p>
<p>The Case Fatality Ratio can be represented as such: <span class="math display">\[
\text{Case Fatality ratio (CFR, in%)} = \frac{\text{Number of deaths from disease}}{\text{Number of confirmed cases of disease}} * 100
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># grouping based on the sub-district and date</span>
<span class='co'># the case_fatality_ratio is based on the sum of deaths over confirmed cases</span>
<span class='co'># note that the CFR is in % form, whcih is why we *100</span>
<span class='va'>CFR</span> <span class='op'>&lt;-</span> <span class='va'>cases_jakarta</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span> <span class='op'>=</span> <span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Sub_District</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`case_fatality_ratio` <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Deaths</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Cases</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
  <span class='co'>#afterwards, pivots the table based on the Dates, showing the cumulative death rate</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>Date</span>,
              values_from <span class='op'>=</span> <span class='va'>case_fatality_ratio</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<center>
<img src="images/CFR.png" style="width:75.0%" />
</center>
<p>Note that for CFR, there are some NaN values on account of the case rate (our denominator) being zero. To accurately reflect the CFR, we will not remove those rows or transform from NaN to 0: on a map, they should reflect as ‘missing values’.</p>
<h3 id="converting-dataframes-to-sf-objects">5.6 Converting dataframes to sf objects</h3>
<p>Before we move on into the mapping, we should convert these dataframes into sf objects.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>combined_jakarta</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>combined_jakarta</span><span class='op'>)</span>

<span class='co'># need to join our previous dataframes with the geospatial data to ensure that geometry column is present</span>
<span class='va'>cases_rate</span> <span class='op'>&lt;-</span> <span class='va'>cases_rate</span><span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>cases_rate</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>)</span>

<span class='va'>death_rate</span> <span class='op'>&lt;-</span> <span class='va'>death_rate</span><span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>death_rate</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>)</span>

<span class='va'>CFR</span> <span class='op'>&lt;-</span> <span class='va'>CFR</span><span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>bd_jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>CFR</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>CFR</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="mapping-monthly-cumulative-cases-rate">6.0 Mapping: Monthly Cumulative Cases Rate</h2>
<h3 id="jenks-choropleth-map">6.1 Jenks Choropleth Map</h3>
<p>I’m planning to use the jenks classification method. It ‘seeks to minimize the average deviation from the class mean while maximizing the deviation from the means of the other groups’ <a href="https://wiki.gis.com/wiki/index.php/Jenks_Natural_Breaks_Classification">(source)</a> and tends to identify real, natural classes within the data. However, jenks will not work as well if the data has a low variance, so let’s check the variance:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># commented out most of the variances due to the increasing variance over time</span>
<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>$</span><span class='va'>`2020-03-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 10.14244</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># var(cases_rate$`2020-04-30`)</span>
<span class='co'># var(cases_rate$`2020-05-31`)</span>
<span class='co'># var(cases_rate$`2020-06-30`)</span>
<span class='co'># var(cases_rate$`2020-07-31`)</span>
<span class='co'># var(cases_rate$`2020-08-31`)</span>
<span class='co'># var(cases_rate$`2020-09-30`)</span>
<span class='co'># var(cases_rate$`2020-10-31`)</span>
<span class='co'># var(cases_rate$`2020-11-30`)</span>
<span class='co'># var(cases_rate$`2020-12-31`)</span>
<span class='co'># var(cases_rate$`2021-01-30`)</span>
<span class='co'># var(cases_rate$`2021-02-28`)</span>
<span class='co'># var(cases_rate$`2021-03-31`)</span>
<span class='co'># var(cases_rate$`2021-04-30`)</span>
<span class='co'># var(cases_rate$`2021-05-31`)</span>
<span class='co'># var(cases_rate$`2021-06-30`)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>$</span><span class='va'>`2021-07-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 105409.9</code></pre>
</div>
<p>Since the variance is increasing over time and seems significant, we can continue with jenks classification. After some testing, having 6 classes seems to be the optimum: too many classes and it becomes hard for the human eye to differentiate between the gradients, while too few classes makes it hard for any differentiation to be seen.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mtennekes/tmap'>tmap</a></span><span class='op'>)</span>

<span class='co'># using the jenks method, with 6 classes</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span><span class='op'>(</span><span class='st'>"2020-03-31"</span>, 
          n<span class='op'>=</span> <span class='fl'>6</span>,
          style <span class='op'>=</span> <span class='st'>"jenks"</span>, 
          title <span class='op'>=</span> <span class='st'>"Case Rate"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_layout</a></span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='st'>"Distribution of COVID-19 Case Rate in March 2020"</span>,
            main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
            main.title.size <span class='op'>=</span> <span class='fl'>1</span>,
            legend.height <span class='op'>=</span> <span class='fl'>0.5</span>, 
            legend.width <span class='op'>=</span> <span class='fl'>0.4</span>,
            frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-44-1.png" width="624" /></p>
</div>
<p>We should plot it for all the months - so let’s have a helper function for plotting this!</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># input: the dataframe and the variable name - in this case, the month </span>
<span class='co'># with style="jenks" for the jenks classification method</span>
<span class='va'>jenks_plot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>varname</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_polygons</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span><span class='op'>(</span><span class='va'>varname</span>, 
          n<span class='op'>=</span> <span class='fl'>6</span>,
          style <span class='op'>=</span> <span class='st'>"jenks"</span>, 
          title <span class='op'>=</span> <span class='st'>"Case Rate"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_layout</a></span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='va'>varname</span>,
          main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
          main.title.size <span class='op'>=</span> <span class='fl'>1.2</span>,
          legend.height <span class='op'>=</span> <span class='fl'>0.45</span>, 
          legend.width <span class='op'>=</span> <span class='fl'>0.35</span>,
          frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>Now, let’s visualise the jenks plots for all months:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># split it up into multiple arranges to make it easier to see</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mtennekes/tmap'>tmap</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-03-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-04-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-05-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-46-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-07-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-08-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-09-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-10-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-46-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-11-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-12-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-01-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-02-28"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-46-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-03-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-04-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-05-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-46-4.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-07-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-46-5.png" width="624" /></p>
</div>
<h3 id="observations-from-jenks-choropleth-map">6.2 Observations from Jenks Choropleth Map</h3>
<p>Do note that each map has its own <em>relative</em> case rate: the ranges gradually grow larger over time with the greater influx of cases. By comparing the change of case rates over the months, there are a number of observations we can make:</p>
<ul>
<li>In the early stages (March 2020 ~ May 2020), there is a visible darkly-coloured ‘center’ slightly to the left of the central Jakarta. In the section below, we learned that this is the <code>SENAYAN</code> sub-district with the highest cases_rate, which is likely where the first cases initially appeared.</li>
<li>Between June 2020 ~ August 2020, there is a noticeable shift for the ‘center’ with the highest case rate - <code>GAMBIR</code>, which would then remain as the sub-district with the highest cases_rate until the end of our data (July 2021)</li>
<li>There is a noticeable darkening of gradient across majority of the map as we transition from the first quarter (March 2020 ~ May 2020) to the next quarter, with special mentions going to July 2020 and October 2020. While, as mentioned, the ranges for each map are not consistent, it is undeniable that more areas are being affected with increasing severity in the later stages as compared to the earlier stages.</li>
<li>The month where the case rate was ramping up in severity across the country (and thus had a significant amount of darker areas) would be 2021 February.</li>
<li>We can roughly track the journey of the COVID-19 ‘clusters’ across the map:
<ul>
<li>Central Cluster: Originated in <code>SENAYAN</code>, circulating within central Jakarta before taking root in <code>GAMBIR</code>.</li>
<li>Southern Cluster: Became prominent in December 2020 onwards, where multiple sub-districts were medium-ly affected. While it pales in comparison to the central cluster, it still has a relatively significant presence.</li>
<li>Northeast Cluster: while the ‘center’ of the cluster (with the most darkest shade) changed frequently in the initial stages, by December 2020 there a pair of confirmed ‘center’ districts that stayed constant throughout 2021. Close proximity of the northeast cluster with the central cluster (specifically, <code>GAMBIR</code>)</li>
<li>Additionally, across the map, it seems that a darker colour will likely have similarly dark colours near it, which could be a sign of spreading to neighbouring districts - we’ll confirm this in 6.4</li>
</ul></li>
</ul>
<p>Let us check for the sub-districts with the highest cases rate at the various stages:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># to check for darkest sub-district in early stages</span>
<span class='va'>cases_rate</span><span class='op'>$</span><span class='va'>Village</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>$</span><span class='va'>`2020-03-31`</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>[1] &quot;SENAYAN&quot;</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># to check for darkest sub-district in the later stages</span>
<span class='va'>cases_rate</span><span class='op'>$</span><span class='va'>Village</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>$</span><span class='va'>`2020-08-31`</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>[1] &quot;GAMBIR&quot;</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># reorder based on decreasing values for Feb 2021, and assign to a new df</span>
<span class='va'>cases_rate_descending</span> <span class='op'>&lt;-</span> <span class='va'>cases_rate</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>$</span><span class='va'>`2021-02-28`</span>,decreasing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,<span class='op'>]</span>
<span class='va'>cases_rate_descending_top5</span> <span class='op'>&lt;-</span> <span class='va'>cases_rate_descending</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>,<span class='op'>]</span>
<span class='va'>cases_rate_descending_top5</span><span class='op'>[</span>,<span class='st'>"Sub_District"</span><span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>Simple feature collection with 5 features and 1 field
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -3630194 ymin: 679978.2 xmax: -3623456 ymax: 690083.2
Projected CRS: DGN95 / Indonesia TM-3 zone 54.1
# A tibble: 5 x 2
  Sub_District                                                geometry
  &lt;chr&gt;                                             &lt;MULTIPOLYGON [m]&gt;
1 GAMBIR         (((-3624851 689984.3, -3624853 689959.1, -3624852 68~
2 SENAYAN        (((-3626081 682271.9, -3626092 682263.2, -3626128 68~
3 KUNINGAN TIMUR (((-3623728 682537.6, -3623715 682486.2, -3623685 68~
4 GUNUNG         (((-3628388 681746.1, -3628389 681733.1, -3628387 68~
5 SETIA BUDI     (((-3624919 685319, -3624920 685274.2, -3624915 6852~</code></pre>
</div>
<p>As we can see, the top 5 sub-districts with the highest cases rate are:</p>
<ul>
<li><code>GAMBIR</code>, which is consistently the top sub-district in that regard,</li>
<li><code>SENAYAN</code> where the first batch of cases likely originated (in the sense that that area had multiple cases that increased and spread to surrounding sub-distrcits, not that that was where the first case occurred),</li>
<li>and other top districts seem to be <code>KUNINGAN TIMUR</code>, <code>GUNUNG</code> and <code>SETIA BUDI</code></li>
</ul>
<h3 id="spatio-temporal-mapping-with-custom-breakpoints">6.3 Spatio-Temporal Mapping with custom breakpoints</h3>
<p>In the above section, we saw each map by their <em>relative</em> case rate - but to see the spatio-temporal progression of case rates, we should set a fixed range. In this case, customising our breakpoints would be ideal - just like above, we’ll be breaking into 6 classes.</p>
<p>Firstly, let’s find the maximum of the case_rates - since the highest case rate is logically in the latest month (July 2021), we’ll find the maximum case_rate from there:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># gets maximum value (case rate) of July 2021 from cases_rate df</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>$</span><span class='va'>`2021-07-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 3808.29</code></pre>
</div>
<p>Now that we know our maximum number, let’s set our breakpoints:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># these breakpoints are chosen based on the jenks breaks ranges from the previous section</span>
<span class='va'>breakpoints</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>20</span>, <span class='fl'>49</span>, <span class='fl'>112</span>, <span class='fl'>550</span>, <span class='fl'>3808</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>This time, let’s test it out on July 2021:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mtennekes/tmap'>tmap</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span><span class='op'>(</span><span class='st'>"2021-07-31"</span>, 
          breaks<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>20</span>, <span class='fl'>49</span>, <span class='fl'>112</span>, <span class='fl'>1105</span>, <span class='fl'>3808</span><span class='op'>)</span>,
          title <span class='op'>=</span> <span class='st'>"Case Rate"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_layout</a></span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='st'>"Distribution of COVID-19 Case Rate in July 2021 (Spatio-Temporal)"</span>,
            main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
            main.title.size <span class='op'>=</span> <span class='fl'>1</span>,
            legend.height <span class='op'>=</span> <span class='fl'>0.5</span>, 
            legend.width <span class='op'>=</span> <span class='fl'>0.4</span>,
            frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-50-1.png" width="624" /></p>
</div>
<p>It might seem pretty skewed towards the ‘heavier’ end, but this is to be expected: after all, this is the end of our dataset where COVID-19 has had over a year of presence in Jakarta. Once again, let’s create a helper function to help us:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>break_plot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>varname</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_polygons</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span><span class='op'>(</span><span class='va'>varname</span>, 
          breaks<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>20</span>, <span class='fl'>49</span>, <span class='fl'>112</span>, <span class='fl'>550</span>, <span class='fl'>3808</span><span class='op'>)</span>,
          title <span class='op'>=</span> <span class='st'>"Case Rate"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_layout</a></span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='va'>varname</span>,
          main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
          main.title.size <span class='op'>=</span> <span class='fl'>1.2</span>,
          legend.height <span class='op'>=</span> <span class='fl'>0.45</span>, 
          legend.width <span class='op'>=</span> <span class='fl'>0.35</span>,
          frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>Now, let’s visualise the custom break plots for all months:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># split it up into multiple arranges to make it easier to see</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mtennekes/tmap'>tmap</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-03-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-04-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-05-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-52-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-07-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-08-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-09-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-10-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-52-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-11-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2020-12-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-01-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-02-28"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-52-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-03-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-04-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-05-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-52-4.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>cases_rate</span>, <span class='st'>"2021-07-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-52-5.png" width="624" /></p>
</div>
<h3 id="observations-from-spatio-temporal-map">6.4 Observations from Spatio-Temporal Map</h3>
<center>
<img src="images/cases_spatio-temporal.gif" />
</center>
<p><em>Made by exporting .pngs of individual plots into an online <a href="https://gifmaker.me/">gifmaker</a></em></p>
<p>Now, we can supplement our observations in 6.2 with a spatio-temporal dimension! Here are the observations made:</p>
<ul>
<li>The general trend of the spread seems to (a) target neighboring districts, which reaffirms our observation in 6.2 on how dark sub-districts are likely to have similarly/slightly less dark sub-districts nearby it and (b) ‘grows from the center’. We can observe that the gradual darkening seems to originate from the Central Jakarta and then outwards - likely due to COVID-19 crossing sub-district borders and increased rate of infection that comes from more cases (more infected people) within the same geographical boundaries.</li>
<li>As expected, <code>SENAYAN</code>, the top sub-district with the highest cases rate, reached the highest class of case rate first. Accordingly, the other top sub-districts eventually joined the highest class of case rate by the end of the dataset.</li>
</ul>
<h2 id="mapping-monthly-cumulative-death-rate">7.0 Mapping: Monthly Cumulative Death Rate</h2>
<h3 id="jenks-choropleth-map-1">7.1 Jenks Choropleth Map</h3>
<p>Like in our monthly cumulative cases in 6.1, we’ll be using the jenks classification method for our choropleth map, but we need to check the variance first:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-03-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 0.07458528</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-04-30`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 0.3333565</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-05-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 0.387508</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-06-30`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 0.4573607</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-07-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 0.5275186</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-08-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 0.7535532</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-09-30`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 0.990763</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-10-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 1.156742</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-11-30`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 1.313623</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-12-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 1.787521</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-01-30`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 3.001775</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-02-28`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 4.046581</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-03-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 5.269923</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-04-30`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 5.513535</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-05-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 6.851983</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-06-30`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 7.674798</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-07-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 13.12748</code></pre>
</div>
<p>The low variance for the initial stages might seem concerning, but it increases over time to a significant level for majority of the data, so we’ll continue with this. In addition, we’ll be using custom breakpoints in the next section for our spatio-temporal analysis, which will supplement our observations.</p>
<p>We’ll need to tweak our <code>jenks_plot</code> helper function a bit due to the class titles:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># input: the dataframe and the variable name - in this case, the month </span>
<span class='co'># with style="jenks" for the jenks classification method</span>
<span class='co'># minor tweak to tm_fill - changed title and palette</span>
<span class='va'>jenks_plot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>varname</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_polygons</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span><span class='op'>(</span><span class='va'>varname</span>, 
          n<span class='op'>=</span> <span class='fl'>6</span>,
          style <span class='op'>=</span> <span class='st'>"jenks"</span>, 
          title <span class='op'>=</span> <span class='st'>"Death Rate"</span>,
          palette<span class='op'>=</span><span class='st'>"Blues"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_layout</a></span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='va'>varname</span>,
          main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
          main.title.size <span class='op'>=</span> <span class='fl'>1.2</span>,
          legend.height <span class='op'>=</span> <span class='fl'>0.45</span>, 
          legend.width <span class='op'>=</span> <span class='fl'>0.35</span>,
          frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>Now, let’s visualise the jenks plots for all months:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># split it up into multiple arranges to make it easier to see</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mtennekes/tmap'>tmap</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-03-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-04-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-05-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-55-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-07-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-08-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-09-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-10-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-55-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-11-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-12-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-01-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-02-28"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-55-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-03-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-04-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-05-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-55-4.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-07-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-55-5.png" width="624" /></p>
</div>
<h3 id="observations-from-jenks-choropleth-map-1">7.2 Observations from Jenks Choropleth Map</h3>
<p>Like before, do note that each map has its own <em>relative</em> death rate: the ranges gradually grow larger over time with the greater influx of deaths By comparing the change of death rates over the months, there are a number of observations we can make:</p>
<ul>
<li>As identified in our cumulative cases mapping, at the start of the dataset (March 2020) <code>SENAYAN</code>, the sub-district with the highest cases rate, similarly has a high death rate</li>
<li>HOWEVER, contrary to expectations, the sub-district with the highest death rate is <code>KARET SEMANGGI</code>, a position it holds from March 2020 to December 2020</li>
<li>From March 2020 to September 2020, <code>GAMBIR</code>, the sub-district that would see the highest case rates till the end of our data (July 2021), actually had a relatively pale colouring compared to its fellow sub-districts. It was only from October 2021 onwards that it started turning dark, before attaining the highest death rate in Jan 2021</li>
<li>November 2020 and March/April 2021 saw a noticeable darkening across majority of the map, indicative of higher death rates across Jakarta - but most of these areas start to pale again when we come to the end of the dataset (July 2021). Darkening across the board is attributed to Jakarta’s rising death rates, though it’s likely than an event, such as a new variant of COVID-19, had hit Jakarta. To explain the paling: certain sub-districts with an abnormally high death rate had started to polarise the rest of the results (pulling the range up)</li>
<li>Additionally, across the map (just like in cumulative cases), it seems that a darker colour will likely have similarly dark colours near it, though it is admittedly patchier than the trend we saw in cumulative cases. It makes sense to see this: the more cases there are, the more likely death from the COVID-19 is, which drives up the ‘death over population’ death rate.</li>
</ul>
<p>Let us check for the sub-districts with the highest cases rate at the various stages:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># to check for darkest sub-district in early stages</span>
<span class='va'>death_rate</span><span class='op'>$</span><span class='va'>Village</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2020-03-31`</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>[1] &quot;KARET SEMANGGI&quot;</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># to check for darkest sub-district in the later stages</span>
<span class='va'>death_rate</span><span class='op'>$</span><span class='va'>Village</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-02-28`</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>[1] &quot;GAMBIR&quot;</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># reorder based on decreasing values for July 2021, and assign to a new df</span>
<span class='va'>death_rate_descending</span> <span class='op'>&lt;-</span> <span class='va'>death_rate</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-06-30`</span>,decreasing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,<span class='op'>]</span>
<span class='va'>death_rate_descending_top5</span> <span class='op'>&lt;-</span> <span class='va'>death_rate_descending</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>,<span class='op'>]</span>
<span class='va'>death_rate_descending_top5</span><span class='op'>[</span>,<span class='st'>"Sub_District"</span><span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>Simple feature collection with 5 features and 1 field
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -3630194 ymin: 679978.2 xmax: -3623648 ymax: 690083.2
Projected CRS: DGN95 / Indonesia TM-3 zone 54.1
# A tibble: 5 x 2
  Sub_District                                                geometry
  &lt;chr&gt;                                             &lt;MULTIPOLYGON [m]&gt;
1 GAMBIR         (((-3624851 689984.3, -3624853 689959.1, -3624852 68~
2 SELONG         (((-3626336 681381.3, -3626335 681357.8, -3626355 68~
3 GUNUNG         (((-3628388 681746.1, -3628389 681733.1, -3628387 68~
4 KARET KUNINGAN (((-3624392 683871, -3624371 683747.4, -3624220 6837~
5 SETIA BUDI     (((-3624919 685319, -3624920 685274.2, -3624915 6852~</code></pre>
</div>
<p>As we can see, the top 5 sub-districts with the highest death rate are:</p>
<ul>
<li><code>GAMBIR</code>, which is consistently the top sub-district both death rate and cases rate</li>
<li><code>GUNUNG</code> and <code>SETIA BUDI</code>, both of which appared in the top 5 sub-districts with the highest cases rate, seems to reinforce the idea that the case rate is highly asociated with the death rate</li>
<li>other sub-districts are <code>KUNINGAN TIMUR</code> AND <code>SELONG</code></li>
<li><code>KARET SEMANGGI</code> which had high death rates from March 2020 till the end of the year did not appear in the top 5 sub-districts</li>
</ul>
<p>Interestingly, despite <code>SENAYAN</code> having one of the highest case rates, it does not appear to be ranked as highly in the death rate. This could indicate two things: either (a) <code>SENAYAN</code>’s local government has pushed out and enforced successful measures involving the local community (or distribution of aid), which has helped the COVID-19-affected patients recover, or (b) the case rate is not as tightly coupled to the death rate as we initially thought. We do not have enough information to vouch for either, but it is worth for local governments on the district or provincial level to survey and check on the measures in place in <code>SENAYAN</code>.</p>
<h3 id="monthly-cumulative-deaths---spatio-temporal-mapping">7.3 Monthly Cumulative Deaths - Spatio-Temporal Mapping</h3>
<p>In the above section, we saw each map by their <em>relative</em> death rate - but to see the spatio-temporal progression of death rates, we should set a fixed range. Just like for our cumulative case rate in 6.3, we should customise our breakpoints and break into 6 classes.</p>
<p>Firstly, let’s find the maximum of the death_rate - with reference to the previous section’s graphs, it seems that the highest death rate is in the latest month (July 2021), we’ll find the maximum death_rate from there:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># gets maximum value (case rate) of July 2021 from cases_rate df</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>death_rate</span><span class='op'>$</span><span class='va'>`2021-07-31`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1] 42.09845</code></pre>
</div>
<p>Now that we know our maximum number, let’s set our breakpoints:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># these breakpoints are chosen based on the jenks breaks ranges from the previous section</span>
<span class='va'>breakpoints</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.4</span>, <span class='fl'>1.3</span>, <span class='fl'>3.4</span>, <span class='fl'>6.5</span>, <span class='fl'>12</span>, <span class='fl'>42</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Once again, let’s tweak our previous helper function:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># minor tweak to tm_fill - change title and palette</span>
<span class='va'>break_plot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>varname</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_polygons</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span><span class='op'>(</span><span class='va'>varname</span>, 
          breaks<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.4</span>, <span class='fl'>1.3</span>, <span class='fl'>3.4</span>, <span class='fl'>6.5</span>, <span class='fl'>12</span>, <span class='fl'>42</span><span class='op'>)</span>,
          title <span class='op'>=</span> <span class='st'>"Death Rate"</span>,
          palette<span class='op'>=</span><span class='st'>"Blues"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_layout</a></span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='va'>varname</span>,
          main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
          main.title.size <span class='op'>=</span> <span class='fl'>1.2</span>,
          legend.height <span class='op'>=</span> <span class='fl'>0.45</span>, 
          legend.width <span class='op'>=</span> <span class='fl'>0.35</span>,
          frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>Now, let’s visualise the custom break plots for all months:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># split it up into multiple arranges to make it easier to see</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mtennekes/tmap'>tmap</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-03-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-04-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-05-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-60-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-07-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-08-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-09-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-10-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-60-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-11-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2020-12-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-01-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-02-28"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-60-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-03-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-04-30"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-05-31"</span><span class='op'>)</span>,
             <span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-60-4.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>break_plot</span><span class='op'>(</span><span class='va'>death_rate</span>, <span class='st'>"2021-07-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-60-5.png" width="624" /></p>
</div>
<h3 id="observations-from-spatio-temporal-map-1">7.4 Observations from Spatio-Temporal Map</h3>
<center>
<img src="images/deaths_spatio-temporal.gif" />
</center>
<p>Let’s supplement our observations in 7.2: - Similar to the case rate in 6.4, the general trend of the spread seems to (a) target neighboring districts and (b) ‘grows from the center’, albeit more patchily and with less intensity than what we saw for the case rate spatio-temporal graphs. The cross-border nature of COVID-19 naturally leads to more cases, which naturally leads to more deaths by COVID-19 complciations, thus increasing the death over population rate. - Contrasting the cases rate map, and related to the low variances of the initial months, there are paler areas all around for the first few months (March 2020~June 2020) before a a marked uptick (and darkening areas) is observed from July onwards. This is in-line with real world events: the life-threatening danger of COVID-19 was always present, but strains of new and nastier variants, alongside stretched resources, which were introduced as time went on are likely to have a hand in the higher death rate.</p>
<h2 id="mapping-case-fatality-ratio">8.0 Mapping: Case Fatality Ratio</h2>
<p>Onto our final mapping! Like the previous two, we’ll be using the jenks classification method for our choropleth map - but this time, we won’t be doing a spatio-temporal map, mainly becuase CFR is not cumulative and thus the map of one month does not ‘build upon’ the map of the previous.</p>
<h3 id="jenks-choropleth-map-2">8.1 Jenks Choropleth Map</h3>
<p>We’ll need to tweak our <code>jenks_plot</code> helper function a bit due to the class titles:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># input: the dataframe and the variable name - in this case, the month </span>
<span class='co'># with style="jenks" for the jenks classification method</span>
<span class='co'># minor tweak to tm_fill - changed title and palette</span>
<span class='va'>jenks_plot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>varname</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>cases_rate</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_polygons</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span><span class='op'>(</span><span class='va'>varname</span>, 
          n<span class='op'>=</span> <span class='fl'>6</span>,
          style <span class='op'>=</span> <span class='st'>"jenks"</span>, 
          title <span class='op'>=</span> <span class='st'>"CFR"</span>,
          palette<span class='op'>=</span><span class='st'>"Reds"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_layout</a></span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='va'>varname</span>,
          main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
          main.title.size <span class='op'>=</span> <span class='fl'>1.2</span>,
          legend.height <span class='op'>=</span> <span class='fl'>0.45</span>, 
          legend.width <span class='op'>=</span> <span class='fl'>0.35</span>,
          frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>Now, let’s visualise the jenks plots for all months:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># split it up into multiple arranges to make it easier to see</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mtennekes/tmap'>tmap</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-03-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-04-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-05-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-62-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-07-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-08-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-09-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-10-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-62-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-11-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2020-12-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2021-01-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2021-02-28"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-62-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2021-03-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2021-04-30"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2021-05-31"</span><span class='op'>)</span>,
             <span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2021-06-30"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-62-4.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_arrange.html'>tmap_arrange</a></span><span class='op'>(</span><span class='fu'>jenks_plot</span><span class='op'>(</span><span class='va'>CFR</span>, <span class='st'>"2021-07-31"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-62-5.png" width="624" /></p>
</div>
<h3 id="observations-from-jenks-choropleth-map-2">7.2 Observations from Jenks Choropleth Map</h3>
<p>By comparing the change of CFR over the months, there are a number of observations we can make:</p>
<ul>
<li>While the first few months (especially March 2020) had missing values, this is because, as mentioned in the 5.3.3 CFR section, there are some NaN values on account of the case rate (our denominator) being zero. They were not removed or transformed so as to accurately reflect the CFR</li>
<li>It’s worth noting that the range in the initial months were very polarised as well - mainly due to the small number of cases in the initial months. A small numerator (number of deaths) over a small denominator (number of cases) would naturally lead to a large, ‘common’ number (eg 33.3, 66.7) This trend, of course, changes as the months pass - by September 2020, the distribution and the values have become to what we know as standard for a choropleth map</li>
<li>Corresponding with what we’ve learned from the cumulative case rate and cumulative death rate, <code>SENAYAN</code>, the top sub-district with the highest cases rate, has a low CFR - which is notable, considering that it’s near Central Jakarta where there are a few sub-districts with intensely high CFR</li>
<li>There is less of a traceable pattern for CFR - there are some sub-districts with consistently high CFR, likely from the high number of cases and deaths, but there are also sub-districts that are intensely dark in one month and then back to middling or even a pale colour the next month. When compared to the more consistent patterns of the cumulative case rate and death rate, the conclusion that we can draw from this is: even though we can trace the patterns and even predict which sub-districts are going to see upticks in their case rate and death rates (based on historical data), the case fatality ratio is not as linear as that, and its complexity means that we need to put in all the more effort into understanding <em>what</em> causes the CFR to drop (what measures were effective?), so as to replicate those successes in other sub-districts and help as many as we can.</li>
</ul>
<h2 id="conclusions">9.0 Conclusions</h2>
<p>As stated when we first started this analysis, our goal is to both visualise and <em>understand</em> the patterns shown in the data. As such, this section is to provide some background information as to the spread of the cases and their corresponding death rate - and especially why we see such a violent surge in the cases rate and death rate.</p>
<p>As <a href="https://theconversation.com/nine-months-and-no-progress-what-went-wrong-in-indonesias-covid-19-responses-and-what-can-be-done-145850">an article discussing Indonesia’s COVID-19 Response Strategies</a> points out, Indonesia suffered poor response time and inefficient strategies for mobilising health resources, an opinion that is reiterated in <a href="https://asia.nikkei.com/Spotlight/Coronavirus/Why-are-Indonesia-s-COVID-cases-surging-Five-things-to-know">an article explaning the surge in Indonesia’s cases</a>.</p>
<p>In addition, poor data-sharing between upper levels of government (country-wide, provincial) and the local governments (district, sub-district) lead to a stifling of local government actions that made it hard for them to act without data or authority - which in turn fed into the lack of community participation. This was not taken advatnage of in the earlier stages when it was easiest to suppress the cases, which in turn caused it to snowball into something critical. This is aggravated by their <a href="https://theconversation.com/three-reasons-why-covid-19-data-in-indonesia-are-unreliable-and-how-to-fix-them-157056">data management, which has 3 major flaws</a></p>
<h3 id="why-this-matters">Why This Matters</h3>
<p>As the COVID-19 pandemic continues, there is an increasing need for transparency and efficiency of data sharing, especially for a country that has governmental bodies on multiple subdivisions such as Indonesia. Increasingly, <a href="https://blogs.adb.org/blog/how-indonesia-s-local-governments-are-getting-vital-covid-19-data-people-who-need-it">local governments find themselves needing to address the need to make information available to the public</a>, and <a href="https://www.un.org/development/desa/dpad/publication/un-desa-policy-brief-61-covid-19-embracing-digital-government-during-the-pandemic-and-beyond/">even the UN encourages governments around the world to embrace the digital government</a></p>
<p>This data is especially significant for the finer-grained levels of local governments - our sub-distrcits. They are the closest to the people in terms of response time, capability of enforcing quarantines and most importantly distributing aid, and oftentimes are more effective and targeted than government efforts. Their sub-district data, in turn, feeds back to the higher-ups: the districts, provinces, and finally country-wide - who can then adjust their regulations, send targeted aid to particular areas, and better address the situation. In other words, <strong>this data enables the different levels of government of the country to work towards a common goal</strong> like a well-oiled machine.</p>
<p>Such data isn’t just limited by sharing up-to-date information, but also extends to <strong>visualising said data in an accurate and easy-to-understand format</strong>. In a situation where response time is key, it is critical to have your readers understand the data from a few key visualisations and start planning how to take action. In addition, such data is transparent to the citizens as well - giving them a gauge of the risk areas and keeping them up-to-date on the measures.</p>
<p>This is the significance of geospatial analytics and of this analysis: <strong>to ensure that data is accurate and understandable for all readers regardless of their background or experience</strong>, in the hopes of enabling action and keeping your readers in the loop.</p>
<h3 id="future-impactsuggestions">Future Impact/Suggestions</h3>
<p>While the COVID-19 pandemic is still ongoing, there are particular events that will undoubtedly lead to spikes in the cases, even with heavy government intervention. For example, a number of citizens <a href="https://www.straitstimes.com/asia/se-asia/jakarta-residents-scramble-to-prevent-spread-of-covid-19-after-hari-raya">circumvented the ban on <em>mudik</em> to visit their for the Hari Raya Aidilfitri holidays</a> -</p>
<p>Additionally distinctions are made between the variant/strain of COVID-19 cases (alpha to delta), I believe we can create a more accurate analysis with more potential information to be gleaned. This is in light of the discovery of the <a href="http://www.xinhuanet.com/english/asiapacific/2021-06/13/c_1310006083.htm">Delta Variant of COVID-19</a>, where its fast spread between sub-districts implies that we should have a separate analysis tracking its spread so as to best contain it and deliver aid to the affected sub-districts.</p>
<h2 id="acknowledgements">10.0 Acknowledgements</h2>
<p>Thank you Prof. Kam for all the lecture notes and hands-on exercises - I took a great deal of reference from them, from data wrangling to mapping!</p>
<h3 id="resources-used">Resources Used</h3>
<p>Here are the list of resources used in this analysis, as well as their links. Special thanks go to the Senior Sample Submissions that Prof. Kam recommended! ❤️</p>
<ul>
<li>Xiao Rong Wong, <a href="https://rpubs.com/xiaorongw/IS415_Take-home_Ex01">Geographic Analysis of the Supply and Demand of Childcare Services in Singapore</a></li>
<li>Rajiv Abraham Xavier, <a href="https://rpubs.com/rax/Take_Home_Ex01">Take Home Exercise 1</a></li>
<li><a href="https://statisticsglobe.com/r-functions-list/">R functions list</a></li>
<li><a href="https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html">kableExtra guide</a></li>
<li><a href="https://www.codegrepper.com/code-examples/r/rename+column+name+in+r">Renaming Columns in R</a></li>
<li><a href="https://readxl.tidyverse.org/articles/articles/column-names.html">readxl column names</a></li>
<li><a href="https://www.marsja.se/how-to-remove-duplicates-in-r-rows-columns-dplyr/">Removing Duplicate Rows &amp; Columns</a></li>
<li><a href="https://stackoverflow.com/questions/16905425/find-duplicate-values-in-r">Finding duplicate columns in R</a></li>
<li><a href="https://www.overleaf.com/learn/latex/Fractions_and_Binomials">Mathematical Expression with LaTex</a></li>
<li><a href="%5BCFR%5D(https://www.who.int/news-room/commentaries/detail/estimating-mortality-from-covid-19#:~:text=Calculating%20CFR%20Case%20fatality%20ratio,severity%20among%20detected%20cases%3A)">Estimating mortality from COVID-19 (CFR article)</a></li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
